# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–º–ø–æ—Ä—Ç—É –¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ —Ä–µ–≤–∏–∑–∏–π –∏–∑ MS Access

**–î–∞—Ç–∞:** 2026-01-15  
**–ê–≤—Ç–æ—Ä:** –ê–ª–µ–∫—Å–∞–Ω–¥—Ä

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ MS Access —Ç–∞–±–ª–∏—Ü `ra_f`, `ra_ft_st`, `ra_ft_s`, `ra_ft_sn` –≤ MS SQL Server.

---

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**Python:**
```bash
pip3 install --user pyodbc
```

**–°–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã:**
- `mdbtools` (–¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏–∑ MS Access)
  - Ubuntu/Debian: `sudo apt-get install mdbtools`
  - macOS: `brew install mdbtools`
  - Windows: –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥ —ç–∫—Å–ø–æ—Ä—Ç–∞)

### 2. –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö

- **MS Access:** –§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è
- **SQL Server:** –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SQL Server

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `05_import_ra_f_data.py`:

```python
SERVER = 'localhost'      # –ò–º—è —Å–µ—Ä–≤–µ—Ä–∞ SQL Server
DATABASE = 'femsq'        # –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
USERNAME = 'sa'           # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
PASSWORD = 'YourPassword123!'  # –ü–∞—Ä–æ–ª—å
```

### 2. –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É MS Access

–£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö MS Access:

```bash
export ACCESS_DB="/path/to/your/database.accdb"
```

–ò–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ —Å–∫—Ä–∏–ø—Ç–µ `import_ra_f.sh`:

```bash
ACCESS_DB="/home/alex/femsq-test/26-0112_import_Excel/24-1125_ra_R_25-0207.accdb"
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
cd code/config/sql
./import_ra_f.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ MS Access –≤ CSV —Ñ–∞–π–ª—ã
3. –ü–æ–¥—Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
4. –ó–∞–ø—É—Å—Ç–∏—Ç Python —Å–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞

### –†—É—á–Ω–æ–π –∏–º–ø–æ—Ä—Ç

#### –®–∞–≥ 1: –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ MS Access

```bash
# –≠–∫—Å–ø–æ—Ä—Ç —Ç–∞–±–ª–∏—Ü –≤ CSV
mdb-export /path/to/database.accdb "ra_ft_st" > /tmp/ra_ft_st_export.csv
mdb-export /path/to/database.accdb "ra_ft_s" > /tmp/ra_ft_s_export.csv
mdb-export /path/to/database.accdb "ra_ft_sn" > /tmp/ra_ft_sn_export.csv
mdb-export /path/to/database.accdb "ra_f" > /tmp/ra_f_export.csv
```

#### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ –∏–º–ø–æ—Ä—Ç–∞

```bash
python3 code/config/sql/05_import_ra_f_data.py
```

---

## üìä –ü–æ—Ä—è–¥–æ–∫ –∏–º–ø–æ—Ä—Ç–∞

–î–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ (—Å —É—á–µ—Ç–æ–º FK constraints):

1. **ra_ft_st** (—Ç–∏–ø—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤) - –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
2. **ra_ft_s** (–∏—Å—Ç–æ—á–Ω–∏–∫–∏/–ª–∏—Å—Ç—ã) - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç ra_ft_st
3. **ra_ft_sn** (–∏–º–µ–Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤) - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç ra_ft_s
4. **ra_f** (—Ñ–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏) - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç ra_dir –∏ ra_a

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π
SELECT 'ra_ft_st' AS table_name, COUNT(*) AS count FROM ags.ra_ft_st
UNION ALL
SELECT 'ra_ft_s', COUNT(*) FROM ags.ra_ft_s
UNION ALL
SELECT 'ra_ft_sn', COUNT(*) FROM ags.ra_ft_sn
UNION ALL
SELECT 'ra_f', COUNT(*) FROM ags.ra_f;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ FK constraints
SELECT 
    f.af_key,
    f.af_name,
    f.af_dir,
    d.dir_name,
    f.af_type,
    f.af_adt_key,
    a.adt_name
FROM ags.ra_f f
LEFT JOIN ags.ra_dir d ON f.af_dir = d.[key]
LEFT JOIN ags.ra_a a ON f.af_adt_key = a.adt_key
WHERE f.af_dir IS NOT NULL
LIMIT 10;
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã:** –°–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –∏–∑ MS Access —á–µ—Ä–µ–∑ `IDENTITY_INSERT`
2. **–ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
   - `af_execute` = 1 (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ)
   - `af_is_done` = 0 (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ)
   - `af_is_source` = 0 (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ)
3. **NULL –∑–Ω–∞—á–µ–Ω–∏—è:** –ü–æ–ª—è `af_source` –∏ `af_adt_key` –º–æ–≥—É—Ç –±—ã—Ç—å NULL
4. **–§–æ—Ä–º–∞—Ç—ã –¥–∞—Ç:** –°–∫—Ä–∏–ø—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞—Ç –∏–∑ MS Access
5. **BIT –ø–æ–ª—è:** –ü—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (true/false, 1/0, yes/no –∏ —Ç.–¥.)

---

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "pyodbc –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
```bash
pip3 install --user pyodbc
```

### –û—à–∏–±–∫–∞: "mdb-export –Ω–µ –Ω–∞–π–¥–µ–Ω"
```bash
# Ubuntu/Debian
sudo apt-get install mdbtools

# macOS
brew install mdbtools
```

### –û—à–∏–±–∫–∞: "CSV —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª MS Access —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `ACCESS_DB`

### –û—à–∏–±–∫–∞: "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SQL Server"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ `05_import_ra_f_data.py`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SQL Server –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –û—à–∏–±–∫–∞: "Violation of PRIMARY KEY constraint"
- –î–∞–Ω–Ω—ã–µ —É–∂–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- –£–¥–∞–ª–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
code/config/sql/
‚îú‚îÄ‚îÄ 05_import_ra_f_data.py    # Python —Å–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞
‚îú‚îÄ‚îÄ import_ra_f.sh             # Bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README_import_ra_f.md      # –≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
```

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-15  
**–ê–≤—Ç–æ—Ä:** –ê–ª–µ–∫—Å–∞–Ω–¥—Ä
