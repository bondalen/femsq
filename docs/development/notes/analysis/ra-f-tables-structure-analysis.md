# –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü ra_f –∏ —Å–ø—Ä–∞–≤–æ—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2026-01-15  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** MS Access –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, VBA –∫–æ–¥ –∏–∑ `Form_ra_a.cls`  
**–ê–≤—Ç–æ—Ä:** –ê–ª–µ–∫—Å–∞–Ω–¥—Ä

---

## üìã –û–±–∑–æ—Ä

–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏ —Ä–µ–≤–∏–∑–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑—É—á–µ–Ω–∏—è VBA –∫–æ–¥–∞ —Ñ–æ—Ä–º—ã `Form_ra_a` –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤ –∫–æ–¥–µ.

---

## 1. –¢–∞–±–ª–∏—Ü–∞ `ra_f` (—Ñ–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)

### 1.1 –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–¢–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ Excel, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö —Ä–µ–≤–∏–∑–∏–∏. –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–≤—è–∑–∞–Ω —Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π (`ra_dir`) –∏ —Ç–∏–ø–æ–º —Ñ–∞–π–ª–∞ (—á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ `ra_ft_*`).

### 1.2 –ü–æ–ª—è —Ç–∞–±–ª–∏—Ü—ã

–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ VBA –∫–æ–¥–∞ (`Form_ra_a.cls`, —Å—Ç—Ä–æ–∫–∏ 82-188):

| –ü–æ–ª–µ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö (MS Access) | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö (SQL Server) | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –ò–Ω–¥–µ–∫—Å |
|------|------------------------|------------------------|----------|--------------|--------|
| `af_key` | Long Integer | BIGINT IDENTITY(1,1) | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ –î–∞ | PRIMARY KEY |
| `af_name` | Text | NVARCHAR(255) | –ò–º—è —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "report.xlsx") | ‚úÖ –î–∞ | NONCLUSTERED |
| `af_dir` | Long Integer | INT | FK ‚Üí `ra_dir.key` (–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏) | ‚úÖ –î–∞ | NONCLUSTERED |
| `af_type` | Long Integer | INT | –¢–∏–ø —Ñ–∞–π–ª–∞ (FK –∫ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤) | ‚úÖ –î–∞ | NONCLUSTERED |
| `af_execute` | Yes/No (Boolean) | BIT | –§–ª–∞–≥: –ø–æ–¥–ª–µ–∂–∏—Ç –ª–∏ —Ñ–∞–π–ª —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—é/–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é | ‚ùå –ù–µ—Ç | NONCLUSTERED |
| `af_source` | Long Integer | INT | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ) | ‚ùå –ù–µ—Ç | - |
| `af_is_done` | Yes/No (Boolean) | BIT | –§–ª–∞–≥: –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ | ‚ùå –ù–µ—Ç | NONCLUSTERED |
| `af_is_source` | Yes/No (Boolean) | BIT | –§–ª–∞–≥: —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ñ–∞–π–ª –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö | ‚ùå –ù–µ—Ç | - |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**
- –ü–æ–ª–µ `af_execute` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å (—Å—Ç—Ä–æ–∫–∞ 122: `If rstFiltered!af_execute Then`)
- –ü–æ–ª–µ `af_source` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 188: `RAAudit_cn_PrDoc xlS, Me!adt_AddRA, Me!adt_results, db, Me!adt_key, yyyy, xlA, rstFiltered!af_source`)
- –ü–æ–ª–µ `af_is_done` –∏ `af_is_source` —É–ø–æ–º—è–Ω—É—Ç—ã –≤ –ø–ª–∞–Ω–µ, –Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –∫–æ–¥–µ - –≤–æ–∑–º–æ–∂–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö –∏–ª–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã

### 1.3 –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏

**–°–≤—è–∑—å —Å `ra_dir`:**
- `ra_f.af_dir` ‚Üí `ra_dir.key`
- –¢–∏–ø: Foreign Key (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ–∞–π–ª

**–°–≤—è–∑—å —Å `ra_a` (—Ä–µ–≤–∏–∑–∏–∏):**
- **–í–ê–ñ–ù–û:** –í —Ç–µ–∫—É—â–µ–º –∫–æ–¥–µ –Ω–µ—Ç —è–≤–Ω–æ–π FK —Å–≤—è–∑–∏ –º–µ–∂–¥—É `ra_f` –∏ `ra_a`
- –§–∞–π–ª—ã —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ `af_dir`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å `ra_a.adt_dir`
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `af_adt_key` (FK ‚Üí `ra_a.adt_key`) –¥–ª—è —è–≤–Ω–æ–π —Å–≤—è–∑–∏ —Ñ–∞–π–ª–æ–≤ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–≤–∏–∑–∏–µ–π

**–°–≤—è–∑—å —Å —Ç–∏–ø–∞–º–∏ —Ñ–∞–π–ª–æ–≤:**
- `ra_f.af_type` ‚Üí —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ (`ra_ft_st`, `ra_ft_s`)
- –¢–∏–ø: Foreign Key (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø —Ñ–∞–π–ª–∞ –∏ –ø—Ä–∞–≤–∏–ª–∞ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### 1.4 –¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤ (–∑–Ω–∞—á–µ–Ω–∏—è `af_type`)

–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ (—Å—Ç—Ä–æ–∫–∏ 114, 140, 144, 181, 200, 227, 314, 341, 399, 508):

| –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
|----------|----------|----------------------|
| 1 | –û—Ç—á—ë—Ç –∞–≥–µ–Ω—Ç–∞ | –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä–æ–π |
| 2 | –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ —Å—Ç—Ä–æ–π–∫–æ–Ω—Ç—Ä–æ–ª—å | –õ–∏—Å—Ç "–•—Ä–°—Ç—Ä–ö–Ω—Ç—Ä–ª", –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `af_source` |
| 3 | –ê—Ä–µ–Ω–¥–∞ –∑–µ–º–ª–∏ | –õ–∏—Å—Ç—ã "–ê—Ä–µ–Ω–¥–∞_–ó–µ–º–ª–∏" –∏ "—É—á–µ—Ç_–∞—Ä–µ–Ω–¥—ã" |
| 4 | –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ `ra_ft_st`, `ra_ft_s`, `ra_ft_sn` |
| 5 | –û—Ç—á—ë—Ç—ã –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–æ—á–µ—Ä–Ω–∏–π –æ–±—ä–µ–∫—Ç `ra_aAllAgents` |
| 6 | –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã (23-0628) | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–æ—á–µ—Ä–Ω–∏–π –æ–±—ä–µ–∫—Ç `ra_aAgFee23_06` |

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –î–ª—è —Ç–∏–ø–æ–≤ 3, 2, 5, 6: –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É = `af_name` (–ø–æ–ª–Ω—ã–π –ø—É—Ç—å)
- –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤: –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É = `dir + "\" + af_name` (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å)

---

## 2. –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤

### 2.1 –¢–∞–±–ª–∏—Ü–∞ `ra_ft_st` (—Ç–∏–ø—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–∏–ø–æ–≤ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ñ–∞–π–ª–æ–≤.

**–ü–æ–ª—è (–Ω–∞ –æ—Å–Ω–æ–≤–µ SQL –∑–∞–ø—Ä–æ—Å–∞, —Å—Ç—Ä–æ–∫–∞ 242):**

| –ü–æ–ª–µ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö (SQL Server) | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ |
|------|------------------------|----------|--------------|
| `st_key` | INT IDENTITY(1,1) | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ –î–∞ |
| `st_name` | NVARCHAR(255) | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ | ‚úÖ –î–∞ |

**–°–≤—è–∑–∏:**
- –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –¥–ª—è `ra_ft_s.ft_s_sheet_type` (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

### 2.2 –¢–∞–±–ª–∏—Ü–∞ `ra_ft_s` (–∏—Å—Ç–æ—á–Ω–∏–∫–∏ / –ª–∏—Å—Ç—ã)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–ª–∏—Å—Ç–æ–≤ Excel) –¥–ª—è —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤.

**–ü–æ–ª—è (–Ω–∞ –æ—Å–Ω–æ–≤–µ SQL –∑–∞–ø—Ä–æ—Å–∞, —Å—Ç—Ä–æ–∫–∏ 241-244):**

| –ü–æ–ª–µ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö (SQL Server) | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ |
|------|------------------------|----------|--------------|
| `ft_s_key` | INT IDENTITY(1,1) | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ –î–∞ |
| `ft_s_type` | INT | FK ‚Üí —Ç–∏–ø —Ñ–∞–π–ª–∞ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `ra_f.af_type`) | ‚úÖ –î–∞ |
| `ft_s_num` | INT | –ù–æ–º–µ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞/–ª–∏—Å—Ç–∞ (–¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏) | ‚úÖ –î–∞ |
| `ft_s_sheet_type` | INT | FK ‚Üí `ra_ft_st.st_key` (—Ç–∏–ø –∏—Å—Ç–æ—á–Ω–∏–∫–∞) | ‚úÖ –î–∞ |

**–°–≤—è–∑–∏:**
- `ra_ft_s.ft_s_type` ‚Üí `ra_f.af_type` (—Å–≤—è–∑—å –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é, –Ω–µ FK)
- `ra_ft_s.ft_s_sheet_type` ‚Üí `ra_ft_st.st_key` (FK)
- –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –¥–ª—è `ra_ft_sn.ftsn_ft_s` (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ó–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –ª–∏—Å—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ —Ç–∏–ø—É —Ñ–∞–π–ª–∞: `WHERE ft_s_type = af_type`
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `ft_s_num` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª–∏—Å—Ç–æ–≤

### 2.3 –¢–∞–±–ª–∏—Ü–∞ `ra_ft_sn` (–∏–º–µ–Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏–º–µ–Ω –ª–∏—Å—Ç–æ–≤ Excel –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.

**–ü–æ–ª—è (–Ω–∞ –æ—Å–Ω–æ–≤–µ SQL –∑–∞–ø—Ä–æ—Å–∞, —Å—Ç—Ä–æ–∫–∞ 252):**

| –ü–æ–ª–µ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö (SQL Server) | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ |
|------|------------------------|----------|--------------|
| `ftsn_key` | INT IDENTITY(1,1) | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ –î–∞ |
| `ftsn_ft_s` | INT | FK ‚Üí `ra_ft_s.ft_s_key` (–∏—Å—Ç–æ—á–Ω–∏–∫/–ª–∏—Å—Ç) | ‚úÖ –î–∞ |
| `ftsn_name` | NVARCHAR(255) | –í–∞—Ä–∏–∞–Ω—Ç –∏–º–µ–Ω–∏ –ª–∏—Å—Ç–∞ Excel | ‚úÖ –î–∞ |

**–°–≤—è–∑–∏:**
- `ra_ft_sn.ftsn_ft_s` ‚Üí `ra_ft_s.ft_s_key` (FK, –æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (`ft_s_key`) –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏–º–µ–Ω –ª–∏—Å—Ç–æ–≤
- –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –ª–∏—Å—Ç–∞ —Å –∫–∞–∂–¥—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º –∏–º–µ–Ω–∏ (—Å—Ç—Ä–æ–∫–∏ 261-268)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏–º–µ–Ω–∏

---

## 3. –î–∏–∞–≥—Ä–∞–º–º–∞ —Å–≤—è–∑–µ–π

```
ra_dir (–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
  ‚îÇ
  ‚îú‚îÄ‚Üí ra_a (—Ä–µ–≤–∏–∑–∏–∏)
  ‚îÇ     ‚îÇ
  ‚îÇ     ‚îî‚îÄ‚Üí (–ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è) ra_f.af_adt_key
  ‚îÇ
  ‚îî‚îÄ‚Üí ra_f (—Ñ–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)
        ‚îÇ
        ‚îú‚îÄ‚Üí ra_f.af_dir ‚Üí ra_dir.key
        ‚îÇ
        ‚îî‚îÄ‚Üí ra_f.af_type ‚Üí (—Å–≤—è–∑—å –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é)
              ‚îÇ
              ‚îî‚îÄ‚Üí ra_ft_s.ft_s_type
                    ‚îÇ
                    ‚îú‚îÄ‚Üí ra_ft_s.ft_s_sheet_type ‚Üí ra_ft_st.st_key
                    ‚îÇ
                    ‚îî‚îÄ‚Üí ra_ft_sn.ftsn_ft_s ‚Üí ra_ft_s.ft_s_key
```

---

## 4. –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 4.1 –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è `ra_f`

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –ø–æ–ª–µ–π:**
- ‚úÖ `af_key` - PK
- ‚úÖ `af_name` - –∏–º—è —Ñ–∞–π–ª–∞
- ‚úÖ `af_dir` - FK –∫ `ra_dir.key`
- ‚úÖ `af_type` - —Ç–∏–ø —Ñ–∞–π–ª–∞ (INT, —Å–≤—è–∑—å —Å–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º–∏)
- ‚úÖ `af_execute` - —Ñ–ª–∞–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (BIT, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1/true)
- ‚úÖ `af_source` - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (INT, nullable)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
- ‚úÖ `af_adt_key` - FK –∫ `ra_a.adt_key` (—è–≤–Ω–∞—è —Å–≤—è–∑—å —Å —Ä–µ–≤–∏–∑–∏–µ–π)
- ‚úÖ `af_is_done` - —Ñ–ª–∞–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (BIT, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0/false)
- ‚úÖ `af_is_source` - —Ñ–ª–∞–≥ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö (BIT, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0/false)
- ‚úÖ `af_created` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ (DATETIME2)
- ‚úÖ `af_updated` - –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ (DATETIME2)

### 4.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ø—Ä–∞–≤–æ—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

**ra_ft_st (—Ç–∏–ø—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤):**
- `st_key` (PK)
- `st_name`
- `st_created`, `st_updated` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**ra_ft_s (–∏—Å—Ç–æ—á–Ω–∏–∫–∏/–ª–∏—Å—Ç—ã):**
- `ft_s_key` (PK)
- `ft_s_type` (INT, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `ra_f.af_type`)
- `ft_s_num` (INT, –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏)
- `ft_s_sheet_type` (FK ‚Üí `ra_ft_st.st_key`)
- `ft_s_created`, `ft_s_updated` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**ra_ft_sn (–∏–º–µ–Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤):**
- `ftsn_key` (PK)
- `ftsn_ft_s` (FK ‚Üí `ra_ft_s.ft_s_key`)
- `ftsn_name` (NVARCHAR(255))
- `ftsn_created`, `ftsn_updated` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 4.3 –ò–Ω–¥–µ–∫—Å—ã

**–î–ª—è `ra_f`:**
- PRIMARY KEY: `af_key`
- NONCLUSTERED: `af_dir` (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
- NONCLUSTERED: `af_type` (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–∏–ø—É)
- NONCLUSTERED: `af_adt_key` (–µ—Å–ª–∏ –¥–æ–±–∞–≤–∏–º –ø–æ–ª–µ)
- NONCLUSTERED: `af_execute` (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤)
- NONCLUSTERED: `af_name` (–¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –∏–º–µ–Ω–∏)

**–î–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü:**
- PRIMARY KEY –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
- NONCLUSTERED: `ra_ft_s.ft_s_type` (–¥–ª—è —Å–≤—è–∑–∏ —Å `ra_f.af_type`)
- NONCLUSTERED: `ra_ft_sn.ftsn_ft_s` (–¥–ª—è —Å–≤—è–∑–∏ —Å `ra_ft_s`)

### 4.4 –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–°–≤—è–∑—å —Ñ–∞–π–ª–æ–≤ —Å —Ä–µ–≤–∏–∑–∏—è–º–∏:**
   - –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: —Ñ–∞–π–ª—ã —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –ø–æ `af_dir = adt_dir`
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—É—é FK `af_adt_key ‚Üí ra_a.adt_key` –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π —Å–≤—è–∑–∏

2. **–¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤:**
   - –ó–Ω–∞—á–µ–Ω–∏—è `af_type` –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ VBA (1, 2, 3, 4, 5, 6)
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —Å–æ–∑–¥–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤:**
   - –î–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
   - –î–ª—è —Ç–∏–ø–æ–≤ 4 –∏ 6 –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ `ra_ft_st`, `ra_ft_s`, `ra_ft_sn` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ª–∏—Å—Ç–æ–≤

---

## 5. –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü –∑–∞–≤–µ—Ä—à–µ–Ω**
2. üìã –°–æ–∑–¥–∞—Ç—å SQL —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü (`04_create_ra_f_tables.sql`)
3. üìã –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–æ—á–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ MS Access
4. üìã –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-15  
**–ê–≤—Ç–æ—Ä:** –ê–ª–µ–∫—Å–∞–Ω–¥—Ä  
**–í–µ—Ä—Å–∏—è:** 1.0.0
