# Детальный анализ структуры Access отчёта mstrgAg_23_Branch_q2m_2408_25

**Дата анализа:** 2025-12-05  
**Автор:** Александр  
**Исходный файл структуры:** `/home/alex/Загрузки/mstrgAg_23_Branch_q2m_2408_25_structure_9.txt`  
**Размер файла:** 3768 строк  
**Связанный план:** `docs/development/notes/chats/chat-plan/chat-plan-25-1205-jasper-report-mstrg.md`  
**Этап выполнения:** 08.1 - Детальный анализ извлечённой структуры Access отчёта

---

## 1. Общая информация об отчёте

### Метаданные отчёта
- **Имя отчёта:** mstrgAg_23_Branch_q2m_2408_25
- **Дата извлечения:** 05.12.2025 14:11:34
- **Файл базы:** 24-1125_ra.accdb
- **Путь к БД:** D:\db\Э644Г_20-1207
- **Версия Access:** 15.0
- **HasModule:** True (отчёт содержит VBA код)

### Параметры страницы
- **Ширина:** 23244 twips (410 mm) = **1162 points**
- **Формат:** A3 Landscape (альбомная ориентация)
- **A3 Landscape:**
  - Ширина: 420 mm = **1191 points**
  - Высота: 297 mm = **842 points**
- **Поля:** ~5 mm слева и справа (1191 - 1162 = 29 points = 10 mm)
- **PictureAlignment:** 2
- **PictureSizeMode:** 0

### Источник данных
```sql
SELECT a.* 
FROM ags_fnIpgChRsltCstUtlPercentBrnRep02_2408_tbl AS a 
ORDER BY a.ipgSh, a.limSort DESC, a.lim DESC;
```

**Соответствие в FEMSQ:** Таблица `ags.spMstrg_2408_ResultSet5` (32 записи, 44 столбца)

### Группировка и сортировка
- **Уровни группировки:** 1 (Group Level 1)
- **Поле группировки:** предположительно `ipgSh` (схема реализации)
- **Сортировка:**
  1. `ipgSh` (схема реализации) - основная группировка
  2. `limSort DESC` (вспомогательное поле для сортировки лимитов в порядке убывания)
  3. `lim DESC` (лимит в порядке убывания)

---

## 2. Структура секций отчёта

### 2.1 Report Header (Заголовок отчёта)
- **Русское название:** `Заголовокотчета`
- **Английское название:** ReportHeader
- **Высота:** 540 twips (9.52 mm) = **27 points**
- **Видимость:** True
- **CanGrow:** True (может расти при необходимости)
- **CanShrink:** False
- **ForceNewPage:** None
- **KeepTogether:** True
- **Фон:** RGB(255, 255, 255) - белый

**Контролы в секции:** 1 (Control #1)

**Назначение:** Основной заголовок отчёта с описанием

### 2.2 Page Header (Верхний колонтитул)
- **Русское название:** `Верхнийколонтитул`
- **Английское название:** PageHeader
- **Высота:** 855 twips (15.08 mm) = **43 points**
- **Видимость:** True
- **CanGrow:** False
- **CanShrink:** False
- **ForceNewPage:** None
- **KeepTogether:** True
- **Фон:** RGB(255, 255, 255) - белый

**Контролы в секции:** 27 (Controls #2-#27)
- 24× Label (заголовки столбцов)
- 2× Unknown_101 (линии разделители)
- 1× Unknown_127 (неизвестный элемент)

**Назначение:** Заголовки столбцов таблицы с многоуровневой структурой

### 2.3 Group Header (Заголовок группы)
- **Русское название:** `Заголовокгруппы`
- **Английское название:** GroupHeader
- **Высота:** 15 twips (0.26 mm) = **1 point** (практически нулевая высота)
- **Видимость:** True
- **CanGrow:** False
- **CanShrink:** False
- **ForceNewPage:** None
- **KeepTogether:** True
- **Фон:** RGB(255, 255, B=255) - белый

**Контролы в секции:** 0

**Назначение:** Заголовок группы (очень мал, фактически не используется визуально)

### 2.4 Detail (Область данных)
- **Русское название:** `Областьданных`
- **Английское название:** Detail
- **Высота:** 1095 twips (19.31 mm) = **55 points**
- **Видимость:** True
- **CanGrow:** Не указано (по умолчанию False)
- **CanShrink:** Не указано (по умолчанию False)
- **Фон:** RGB(255, 255, 255) - белый

**Контролы в секции:** 42 (Controls #28-#69)
- 41× TextBox (поля данных)
- 1× Unknown_101 (линия разделитель сверху)

**VBA код для условного форматирования:**
```vba
Private Sub ОбластьДанных_Format(Cancel As Integer, FormatCount As Integer)
    On Error Resume Next
    Select Case Me!ogNm
        Case "ИТОГО"
            ОбластьДанных.BackColor = 14020607  ' RGB(255, 214, 214) - светло-розовый
            ОбластьДанных.AlternateBackColor = 14020607
        Case "Заказчики"
            ОбластьДанных.BackColor = 14020607
            ОбластьДанных.AlternateBackColor = 14020607
        Case Else
            ОбластьДанных.BackColor = vbWhite
            ОбластьДанных.AlternateBackColor = RGB(242, 242, 242)  ' Светло-серый для чередования
    End Select
End Sub
```

**Назначение:** Строки данных с условным форматированием фона для итоговых записей

### 2.5 Report Footer (Нижний колонтитул отчёта)
- **Русское название:** `Примечаниеотчета`
- **Английское название:** ReportFooter
- **Высота:** 0 twips (0 mm) = **0 points**
- **Видимость:** True
- **Фон:** RGB(255, 255, 255) - белый

**Контролы в секции:** 1 (Control #70)
- 1× Rectangle (прямоугольник/линия)

**Назначение:** Нижняя граница отчёта (нулевая высота, только линия)

---

## 3. Детальный анализ контролов (70 штук)

### 3.1 Report Header (1 контрол)

#### Control #1: Заголовок отчёта
- **Имя:** Надпись1
- **Тип:** Label (100)
- **Секция:** Report Header
- **Координаты:**
  - Left: 0 twips (0 mm) = **0 pt**
  - Top: 0 twips (0 mm) = **0 pt**
  - Width: 23128 twips (407.95 mm) = **1156 pt**
  - Height: 855 twips (15.08 mm) = **43 pt**
- **Форматирование:**
  - Шрифт: Times New Roman, размер 8, **жирный** (FontWeight=700)
  - Цвет текста: RGB(127, 127, 127) - серый
  - Цвет фона: RGB(255, 255, 255) - белый, прозрачный
  - Выравнивание: Left (2)
- **Текст:**
  ```
  Исполнение плана капитального строительства по отдельным программам и подразделениям 
  в соответствии с утверждённым финансированием при исполнении на 2025 год,
  утверждённого постановлением 03.09.2025
  (по состоянию на 17.09.2025)
  ```
- **Границы:** Прозрачные

---

### 3.2 Page Header (27 контролов)

#### Control #2: "не используются" (СКРЫТЫЙ)
- **Имя:** Надпись481
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 263 pt, y: 43 pt
  - width: 77 pt, height: 11 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(192, 80, 77) - красный
  - Фон: белый непрозрачный
- **Видимость:** **False** (скрытый контрол)
- **Текст:** "не используются"

**Примечание:** Этот контрол скрыт, не нужно добавлять в JasperReports

#### Control #3: Горизонтальная линия-разделитель
- **Имя:** ОбластьЗаголовка2
- **Тип:** Unknown_101 (101) - линия/прямоугольник
- **Секция:** Page Header
- **Координаты:**
  - x: 0 pt, y: 0 pt
  - width: 1153 pt, **height: 0 pt** (горизонтальная линия)
- **Форматирование:**
  - Фон: RGB(253, 234, 218) - светло-оранжевый/персиковый
  - Border: прозрачный
  - BorderColor: RGB(198, 217, 241) - светло-голубой

**Назначение:** Верхняя декоративная линия заголовка таблицы

#### Control #4: "Филиал" (Заголовок столбца 1)
- **Имя:** Надпись3
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 0 pt, y: 0 pt
  - width: 99 pt, height: 54 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
- **Текст:** "Филиал"

#### Control #5: "Номер филиала (без ИСО)" (Заголовок столбца 2)
- **Имя:** Надпись27
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 99 pt, y: 0 pt
  - width: 80 pt, height: 54 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
- **Текст:** 
  ```
  Номер филиала
  (без ИСО)
  ```

#### Control #6: "Лимит" (Заголовок верхнего уровня)
- **Имя:** Надпись41
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 178 pt, y: 0 pt
  - width: 85 pt, height: 13 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
- **Текст:** "Лимит"

**Примечание:** Этот заголовок является родительским для Control #17, #18, #19 (ИТОГО, ИНВЕСТИЦИОННАЯ, на 2024 г. программ)

#### Control #7: "Исполнение\nсметного лимита" (Заголовок столбца 3)
- **Имя:** Надпись55
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 263 pt, y: 0 pt
  - width: 77 pt, height: 32 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
- **Текст:** 
  ```
  Исполнение
  сметного лимита
  ```

#### Control #8: "% \nИсполнения\nсметного лимита" (Заголовок столбца 4)
- **Имя:** Надпись69
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 340 pt, y: 0 pt
  - width: 46 pt, height: 54 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
- **Текст:** 
  ```
  % 
  Исполнения
  сметного лимита
  ```

#### Control #9: "Превышен лимит бизнес сметного плана" (Заголовок столбца 5)
- **Имя:** Надпись91
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 386 pt, y: 0 pt
  - width: 74 pt, height: 32 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
- **Текст:** "Превышен лимит бизнес сметного плана"

#### Control #10: "Месяц" (Заголовок столбца 6)
- **Имя:** Надпись106
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 460 pt, y: 13 pt
  - width: 52 pt, height: 41 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
- **Текст:** "Месяц"

#### Control #11: " в разрезе видов контрагентов финанс" (Заголовок раздела уровня 1)
- **Имя:** Надпись133
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 512 pt, y: 13 pt
  - width: 436 pt, height: 10 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - **Фон: RGB(253, 234, 218) - светло-оранжевый/персиковый, НЕПРОЗРАЧНЫЙ**
  - Выравнивание: Left (2)
- **Текст:** " в разрезе видов контрагентов финансирования"

**Примечание:** Это заголовок верхнего уровня для раздела, охватывающего несколько столбцов

#### Control #12-#25: Остальные заголовки столбцов
Аналогичная структура для всех остальных заголовков столбцов в Page Header

#### Control #17: "ИТОГО " (Подзаголовок красного цвета)
- **Имя:** Надпись296
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 178 pt, y: 43 pt
  - width: 85 pt, height: 11 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - **Цвет текста: RGB(192, 80, 77) - КРАСНЫЙ**
  - Фон: белый непрозрачный
  - Выравнивание: Left (2)
- **Текст:** "ИТОГО "

**Назначение:** Подзаголовок для столбца с итоговыми данными (красным выделен)

#### Control #18: "ИНВЕСТИЦИОННАЯ" (Подзаголовок синего цвета)
- **Имя:** Надпись297
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 178 pt, y: 32 pt
  - width: 85 pt, height: 11 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - **Цвет текста: RGB(47, 54, 153) - СИНИЙ**
  - Фон: белый непрозрачный
  - Выравнивание: Left (2)
- **Текст:** "ИНВЕСТИЦИОННАЯ"

**Назначение:** Подзаголовок для столбца с данными инвестиционной схемы (синим выделен)

#### Control #19: "на 2024 г.\nпрограмм" (Подзаголовок)
- **Имя:** Надпись298
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 178 pt, y: 13 pt
  - width: 85 pt, height: 19 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(127, 127, 127) - серый
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
- **Текст:** 
  ```
  на 2024 г.
  программ
  ```

#### Control #27: "при дополнительном утверждении" (Подзаголовок КРАСНОГО цвета)
- **Имя:** Надпись571
- **Тип:** Label (100)
- **Секция:** Page Header
- **Координаты:**
  - x: 386 pt, y: 32 pt
  - width: 74 pt, height: 22 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - **Цвет текста: RGB(255, 0, 0) - ЯРКО-КРАСНЫЙ**
  - Фон: белый прозрачный
  - Выравнивание: Left (2)
  - BorderColor: RGB(166, 166, 166) - серый
- **Текст:** "при дополнительном утверждении"

**Назначение:** Важное примечание красным цветом

---

### 3.3 Detail (42 контрола)

#### Control #28: Горизонтальная линия разделитель сверху строки
- **Имя:** ОбластьЗаголовка0
- **Тип:** Unknown_101 (101) - линия
- **Секция:** Detail
- **Координаты:**
  - x: 0 pt, y: 0 pt
  - width: 1153 pt, **height: 0 pt**
- **Форматирование:**
  - Фон: RGB(198, 217, 241) - светло-голубой
  - Border: прозрачный
- **Назначение:** Линия разделитель между строками данных

#### Control #29: ogNm (Название организации/филиала)
- **Имя:** ogNm
- **Тип:** TextBox (109)
- **Секция:** Detail
- **ControlSource:** ogNm
- **Координаты:**
  - x: 0 pt, y: 0 pt
  - width: 99 pt, height: 9 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(64, 64, 64) - тёмно-серый
  - Фон: белый прозрачный
  - Выравнивание: General (Left по умолчанию) (1)
  - CanGrow: False
  - CanShrink: False
- **Формат:** Нет (текстовое поле)
- **Примечание:** Первый столбец - название организации

#### Control #30: lim (Номер филиала/лимит)
- **Имя:** lim
- **Тип:** TextBox (109)
- **Секция:** Detail
- **ControlSource:** lim
- **Координаты:**
  - x: 99 pt, y: 0 pt
  - width: 80 pt, **height: 27 pt** (высокая ячейка)
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(64, 64, 64) - тёмно-серый
  - Фон: белый прозрачный
  - **Выравнивание: Center (3)**
  - CanGrow: False
  - CanShrink: False
- **Формат:** Нет (числовое поле без форматирования)

#### Control #31: ag_lim (Лимит агентской схемы)
- **Имя:** ag_lim
- **Тип:** TextBox (109)
- **Секция:** Detail
- **ControlSource:** ag_lim
- **Координаты:**
  - x: 178 pt, y: 0 pt
  - width: 85 pt, height: 9 pt
- **Форматирование:**
  - Шрифт: Times New Roman, размер 7
  - Цвет текста: RGB(64, 64, 64) - тёмно-серый
  - **Выравнивание: Center (3)**
- **Формат:** Нет (числовое поле)