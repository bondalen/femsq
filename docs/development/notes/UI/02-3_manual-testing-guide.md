**Дата:** 2025-11-13  
**Автор:** Александр  
**Этап:** 02.3

# Руководство по ручному тестированию UX

## Подготовка к тестированию

### 1. Запуск backend-сервера (опционально)

Для полного тестирования с реальными данными нужен запущенный backend:

```bash
# Перейти в директорию web-модуля (Spring Boot приложение находится здесь)
cd /home/alex/projects/java/spring/vue/femsq/code/femsq-backend/femsq-web

# Запустить Spring Boot приложение
mvn spring-boot:run

# Или если уже собран JAR:
java -jar target/femsq-web-*.jar

# Альтернативный способ из корня backend (с указанием модуля):
cd /home/alex/projects/java/spring/vue/femsq/code/femsq-backend
mvn -pl femsq-web spring-boot:run
```

Backend должен быть доступен на `http://localhost:8080`.

**Примечание:** Если backend не запущен, приложение работает в демо-режиме с имитацией подключения, но реальные данные организаций загружаться не будут.

#### Решение проблемы "Адрес уже используется" (порт 8080 занят)

Если при запуске backend появляется ошибка `java.net.BindException: Адрес уже используется`, выполните:

```bash
# Вариант 1: Найти и остановить процесс на порту 8080
sudo lsof -i :8080
# Затем убить процесс (замените PID на найденный):
sudo kill -9 <PID>

# Вариант 2: Использовать другой порт
# Создайте файл application-local.yml в femsq-web/src/main/resources/:
# server:
#   port: 8081
# Затем запустите с профилем:
mvn spring-boot:run -Dspring-boot.run.profiles=local

# Вариант 3: Изменить порт через переменную окружения
SERVER_PORT=8081 mvn spring-boot:run
```

После изменения порта не забудьте обновить `VITE_API_BASE_URL` в frontend (файл `.env.local`).

### 2. Запуск frontend приложения

```bash
# Перейти в директорию frontend
cd /home/alex/projects/java/spring/vue/femsq/code/femsq-frontend-q

# Установить зависимости (если ещё не установлены)
npm install

# Запустить dev-сервер
npm run dev
```

Приложение откроется в браузере по адресу `http://localhost:5173` (или другому порту, если 5173 занят).

### 3. Настройка переменных окружения (опционально)

Если backend работает на другом порту, создайте файл `.env.local`:

```env
VITE_API_BASE_URL=http://localhost:8080
```

## Выполнение тестов

### Тест 1: Первое подключение

**Цель:** Проверить успешное подключение к БД и переход к экрану организаций.

**Шаги:**
1. Откройте приложение в браузере (`http://localhost:5173`)
2. **Проверьте начальное состояние:**
   - Верхняя панель отображается
   - Кнопка "Подключение к БД" видна и активна
   - Кнопка "Организации" неактивна (затемнена)
   - Строка состояния показывает "Ожидает подключения" (серый цвет)
3. **Нажмите "Подключение к БД"**
   - Открывается модальное окно
   - Поля формы предзаполнены (если есть сохранённые значения)
   - Поля "Пароль" и "Токен" пустые
4. **Заполните форму подключения:**
   - Host: `localhost` (или ваш сервер)
   - Port: `1433` (или ваш порт)
   - Database: `FishEye` (или ваша БД)
   - Auth Mode: `SQL Server Authentication`
   - Username: `sa` (или ваш пользователь)
   - Password: ваш пароль
5. **Нажмите "Подключить"**
   - Модалка показывает "Проверяем данные…" (validating)
   - Затем "Устанавливаем соединение…" (connecting)
   - Строка состояния обновляется: "Подключение…"
6. **Проверьте успешное подключение:**
   - Модалка показывает "Подключено" (success) и закрывается автоматически
   - Строка состояния зелёная: "Подключено к [schema]"
   - Кнопка "Организации" становится активной
7. **Нажмите "Организации"**
   - Открывается экран организаций
   - Таблица показывает индикатор загрузки
8. **Проверьте загрузку данных:**
   - Таблица отображает список организаций
   - Первая организация автоматически выбрана
   - Справа отображается карточка с деталями организации
   - В карточке виден список агентов (контактных лиц)

**Ожидаемый результат:** ✅ Все шаги выполняются без ошибок, данные загружаются корректно.

---

### Тест 2: Ошибка подключения

**Цель:** Проверить обработку ошибок подключения и возможность повторной попытки.

**Шаги:**
1. Откройте модалку подключения (кнопка "Подключение к БД")
2. **Введите неверные данные:**
   - Неверный пароль
   - Или неверный host/port
3. **Нажмите "Подключить"**
   - Модалка переходит в состояние "error"
   - Под полями отображается сообщение об ошибке (красный цвет)
   - Строка состояния показывает "Ошибка подключения" (красный цвет)
4. **Исправьте данные:**
   - Введите правильный пароль
   - Или исправьте другие параметры
5. **Повторите подключение:**
   - Нажмите "Подключить" снова
   - Модалка проходит через validating → connecting → success
6. **Проверьте успешное подключение:**
   - Модалка закрывается
   - Строка состояния зелёная
   - Кнопка "Организации" активна

**Ожидаемый результат:** ✅ Ошибка отображается понятно, повторная попытка успешна.

**Примечание:** В демо-режиме первая попытка всегда успешна, вторая - с ошибкой (чередуется через `simulateErrorToggle`).

---

### Тест 3: Фильтрация и пагинация

**Цель:** Проверить работу фильтра по названию и пагинации списка организаций.

**Предварительные условия:** Приложение подключено к БД, открыт экран организаций.

**Шаги:**
1. **Проверьте фильтр:**
   - Найдите поле "Поиск по названию" над таблицей
   - Введите часть названия организации (например, "ООО")
   - Подождите ~400ms (debounce)
   - Таблица обновляется, показывая только подходящие организации
2. **Проверьте очистку фильтра:**
   - Нажмите кнопку "X" в поле поиска
   - Таблица возвращается к полному списку
3. **Проверьте пагинацию:**
   - Если организаций больше, чем размер страницы (по умолчанию 10)
   - Внизу таблицы отображается пагинация
   - Нажмите на номер страницы "2"
   - Таблица загружает следующую страницу
   - Выбранная организация сбрасывается
4. **Проверьте изменение размера страницы:**
   - Найдите выпадающий список "На странице"
   - Выберите "5"
   - Таблица обновляется, показывая 5 записей на странице
   - Количество страниц увеличивается
5. **Проверьте сортировку:**
   - Найдите выпадающий список "Сортировка"
   - Выберите "Наименование ↓"
   - Таблица сортируется по убыванию названия

**Ожидаемый результат:** ✅ Фильтр работает с debounce, пагинация переключает страницы, размер страницы изменяется, сортировка работает.

---

### Тест 4: Адаптивность

**Цель:** Проверить адаптацию интерфейса под разные размеры экрана.

**Шаги:**
1. **Десктоп (≥1280px):**
   - Откройте приложение в полноэкранном режиме
   - Проверьте: все кнопки видны в верхней панели
   - Таблица и карточка организации расположены рядом (две колонки)
2. **Планшет (768px - 1279px):**
   - Уменьшите окно браузера до ширины ~1024px
   - Проверьте: layout адаптируется
   - Таблица может стать уже, но остаётся читаемой
3. **Мобильный (≤767px):**
   - Уменьшите окно до ширины ~375px (или используйте DevTools для эмуляции мобильного)
   - Проверьте:
     - Кнопки в верхней панели сворачиваются в burger-меню (☰)
     - Таблица прокручивается горизонтально
     - Карточка организации располагается под таблицей
     - Все элементы остаются доступными

**Ожидаемый результат:** ✅ Интерфейс адаптируется под размер экрана, все элементы доступны на всех устройствах.

**Совет:** Используйте DevTools браузера (F12) → Toggle device toolbar (Ctrl+Shift+M) для эмуляции разных устройств.

---

### Тест 5: Отключение и повторное подключение

**Цель:** Проверить корректный сброс состояния при отключении.

**Предварительные условия:** Приложение подключено, открыт экран организаций, выбрана организация.

**Шаги:**
1. **Найдите кнопку "Отключиться":**
   - В строке состояния (внизу экрана) справа
   - Или в верхней панели (если есть)
2. **Нажмите "Отключиться":**
   - Строка состояния показывает "Отключение…"
   - Кнопка "Организации" становится неактивной
   - Данные организаций исчезают
3. **Проверьте состояние после отключения:**
   - Строка состояния возвращается к "Ожидает подключения" (серый)
   - Экран организаций скрывается (или показывает пустое состояние)
   - Выбранная организация сброшена
4. **Повторно подключитесь:**
   - Нажмите "Подключение к БД"
   - Заполните форму (значения сохранены)
   - Нажмите "Подключить"
5. **Проверьте загрузку данных заново:**
   - После успешного подключения откройте "Организации"
   - Данные загружаются заново
   - Первая организация выбирается автоматически

**Ожидаемый результат:** ✅ Состояние сбрасывается корректно, повторное подключение работает, данные загружаются заново.

---

## Дополнительные проверки

### Проверка индикаторов загрузки

- При загрузке организаций таблица показывает спиннер
- При загрузке агентов в карточке показывается маленький спиннер
- Строка состояния обновляется с информацией о текущем действии

### Проверка сообщений об ошибках

- При ошибке API отображается красный баннер с текстом ошибки
- При ошибке загрузки агентов отображается жёлтый баннер
- Сообщения понятны и информативны

### Проверка toast-уведомлений

- При успешном подключении может появиться toast-уведомление (если реализовано)
- При ошибках отображаются toast с типом "negative"

## Запись результатов

После выполнения каждого теста отметьте результат в чеклисте:

- ✅ **Успешно** - все шаги выполнены, ожидаемый результат достигнут
- ⚠️ **Частично** - большинство шагов выполнены, есть незначительные проблемы
- ❌ **Неудачно** - тест не пройден, есть критические проблемы

Запишите найденные проблемы в раздел "Выявленные проблемы" документа `02-3_ux-tests-checklist.md`.

## Советы по тестированию

1. **Используйте DevTools браузера:**
   - F12 для открытия инструментов разработчика
   - Network tab для проверки API запросов
   - Console для проверки ошибок JavaScript
   - Application/Storage для проверки сохранённых данных

2. **Проверяйте разные сценарии:**
   - Пустая база данных
   - Большое количество организаций (>100)
   - Медленное соединение (throttling в DevTools)

3. **Тестируйте на разных браузерах:**
   - Chrome/Edge (Chromium)
   - Firefox
   - Safari (если доступен)

4. **Проверяйте доступность:**
   - Навигация с клавиатуры (Tab, Enter, Esc)
   - Читаемость текста (контрастность)
   - Работа без мыши

## Устранение проблем

### Приложение не запускается

```bash
# Проверьте установку зависимостей
npm install

# Проверьте версию Node.js (должна быть ≥18)
node --version

# Очистите кэш и переустановите
rm -rf node_modules package-lock.json
npm install
```

### Backend не отвечает

- Проверьте, что backend запущен на порту 8080
- Проверьте переменную окружения `VITE_API_BASE_URL`
- Проверьте CORS настройки backend (если есть)

### Данные не загружаются

- Проверьте консоль браузера на ошибки
- Проверьте Network tab в DevTools
- Убедитесь, что backend доступен и возвращает данные

---

**Дата создания:** 2025-11-13  
**Версия:** 1.0
