**Дата:** 2025-11-11  
**Автор:** Александр  
**Этап:** 02.1.3

### UX-описание экрана организаций
**Цели**: предоставить пользователю быстрый доступ к списку организаций, детальной карточке и связанным агентам, сохраняя контекст подключений.

**Размещение в каркасе**
- Экран открывается после нажатия `Организации` в верхней панели каркаса (при состоянии `connected`).
- Заголовок представления «Организации» отображается в основной области контента, ниже — панели фильтров, таблицы и подробностей.

**Структура экрана**
1. **Хедер экрана**
   - Заголовок «Организации» + счётчик найденных записей (`N организаций`).
   - Вторичная строка с кратким описанием текущей схемы/подключения (берётся из глобального состояния).
   - Команды: `Обновить`, `Экспорт`, `Фильтры`.

2. **Панель фильтров** (collapsible, по умолчанию открыта)
   - Поля быстрого поиска: `ogKey` (точный идентификатор), `ogName` (подстрочный поиск), `status` (выпадающий список).
   - Кнопки: `Применить`, `Очистить`, `Сохранить фильтр`.
   - Иконка статуса фильтра (активен/нет) отображается рядом с заголовком панели.

3. **Таблица организаций**
   - Колонки: `ogKey`, `ogName`, `ogType`, `region`, `contractsCount`, `updatedAt`.
   - Сортировка по `ogName` и `updatedAt`, опционально по `region`.
   - Строки поддерживают выбор (single-select); выбранная подсвечивается и раскрывает детали справа.
   - Пустое состояние: сообщение «Организации не найдены» + кнопка «Сбросить фильтры».
   - Интерактивные подсказки по колонкам (`?` для объяснения метрик).

4. **Карточка организации** (справа, в макете панель 30% ширины)
   - Отображается при выборе строки, показывает все поля таблицы + дополнительные (`fullName`, `inn`, `ogrn`, `address`, `contactPerson`).
   - Вверху: заголовок `ogName`, рядом статус (цвет/иконка).
   - Блоки «Общая информация», «Контракты», «Комментарий».
   - Кнопки действий: `Открыть карточку`, `Скопировать идентификатор`.
   - Пустое состояние при отсутствии выбора: placeholder «Выберите организацию для просмотра» + иконка.

5. **Список агентов** (вкладка внутри карточки)
   - Табличный список без пагинации (до 20 строк), колонки: `agentKey`, `agentName`, `role`, `phone`.
   - При большем количестве агентов появляется кнопка «Показать всех» с переходом на отдельную страницу.
   - Пустое состояние: «Агентов не найдено» + кнопка «Обновить».

6. **Строка уведомлений/лоадера**
   - Под таблицей отображается прогресс при загрузке данных.
   - В случае ошибок выводится alert с текстом проблемы и кнопкой «Повторить».

**Сценарии работы пользователя**
1. Подключение → переход на экран → автоматическая загрузка списка (статус `loading`).
2. Пользователь использует фильтры, нажимает `Применить` → таблица и счётчик обновляются.
3. Пользователь выбирает организацию → карточка заполняется данными, список агентов подтягивается асинхронно.
4. При изменении фильтров выбранная организация сбрасывается, отображается placeholder.
5. Пользователь жмёт `Обновить` → данные перечитываются, статус в строке состояния показывает «Обновление…».

**Состояния экрана**
- `loading`: таблица мутнеет, отображается спиннер и текст «Загрузка организаций…».
- `ready`: данные отображаются, подсказки активны.
- `empty`: таблица показывает пустое состояние после запроса.
- `error`: таблица и карточка скрывают данные, показывается ошибка.
- `selectionLoading`: при выборе организации пока не загрузились детали/агенты.

**Интеграция с глобальным каркасом**
- Верхняя панель подсвечивает кнопку `Организации` как активную.
- Нижняя строка состояния показывает число найденных организаций и текущую схему.
- При ошибках загрузки строка состояния отображает «Ошибка загрузки организаций» + кнопку «Подробнее».

**UX-подсказки**
- Ховер по строке таблицы показывает быстрые действия (`просмотр`, `копировать ogKey`).
- В карточке доступна кнопка «Поделиться» (формирует deep-link на организацию).
- На мобильных устройствах таблица сворачивается в карточки, карточка организации открывается во всплывающем листе.
