VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "ra"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Compare Database

' объект *Отчёт агента*

' ###################################################################################################################################################
' область определения закрытых пременных, содержащих значения свойств ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' !!! не нужно их писать в других местах, это приведет к ошибке. 07.07.2022
' ключ объекта #Отчёт агента#
Private mlngRaKey As Long
' база данных
Private mdbDb As DAO.Database
' область определения закрытых пременных, содержащих значения свойств ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' ###################################################################################################################################################


' ###################################################################################################################################################
' геттеры и сеттеры (леттеры) свойств

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *ключ объекта #Отчёт агента#*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *ключ объекта #Отчёт агента#*
Public Property Get lngRaKey() As Long
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    lngRaKey = mlngRaKey
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *ключ объекта #Отчёт агента#*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' геттер свойства *номер отчёта агента* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get strRaNum() As String
    Const cstrTitle As String = "Процедура *Геттер свойства *номер отчёта агента*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaNum = readFieldVar("ra_num")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *стройка (стройка-агент-пункт)*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *стройка (стройка-агент-пункт)* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get lngRaCstAgPn() As Long
    Const cstrTitle As String = "Процедура *Геттер свойства *стройка (стройка-агент-пункт)*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    lngRaCstAgPn = readFieldVar("ra_cac")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *стройка (стройка-агент-пункт)*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' геттер свойства *тип отчёта агента* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get strRaType() As String
    Const cstrTitle As String = "Процедура *Геттер свойства *тип отчёта агента*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaType = readFieldVar("ra_type")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *тип работы отчёта агента*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *тип работы отчёта агента*
Public Property Get strRaTypeWork() As Variant
    Const cstrTitle As String = "Процедура *Геттер свойства *тип работы отчёта агента*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaTypeWork = readFieldVar("ra_work_type")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *тип работы отчёта агента*
Public Property Let strRaTypeWork(ByVal strRaTypeWorkNew As Variant)
    Const cstrTitle As String = "Процедура *Леттер свойства *тип работы отчёта агента*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_work_type", strRaTypeWorkNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *тип работы отчёта агента*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *период отчёта агента*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *период отчёта агента* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get lngRaPeriod() As Long
    Const cstrTitle As String = "Процедура *Геттер свойства *период отчёта агента*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    lngRaPeriod = readFieldVar("ra_period")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *период отчёта агента*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *примечания временные, про создание*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *примечания временные, про создание*
Public Property Get strRaNoteT() As Variant
    Const cstrTitle As String = "Процедура *Геттер свойства *примечания временные, про создание*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaNoteT = readFieldVar("ra_note_t")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *примечания временные, про создание*
Public Property Let strRaNoteT(ByVal strRaNoteTNew As Variant)
    Const cstrTitle As String = "Процедура *Леттер свойства *примечания временные, про создание*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_note_t", strRaNoteTNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *примечания временные, про создание*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата создания отчёта в БД*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата создания отчёта в БД* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get dateRaCreated() As Variant
    Const cstrTitle As String = "Процедура *Геттер свойства *дата создания отчёта в БД*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaCreated = readFieldVar("ra_created")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата создания отчёта в БД*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *примечания*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *примечания*
Public Property Get strRaNote() As Variant
    Const cstrTitle As String = "Процедура *Геттер свойства *примечания*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaNote = readFieldVar("ra_note")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *примечания*
Public Property Let strRaNote(ByVal strRaNoteNew As Variant)
    Const cstrTitle As String = "Процедура *Леттер свойства *примечания*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_note", strRaNoteNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *примечания*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата периода*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата периода* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get dateRaPeriodDate() As Date
    Const cstrTitle As String = "Процедура *Геттер свойства *дата периода*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaPeriodDate = readFieldVar("ra_datePeriod")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата периода*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' ===================================================================================================================================================
' группа свойств *письмо поступления*
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *письмо поступления*
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *письмо поступления*
Public Property Get strRaArrived() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *письмо поступления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaArrived = readFieldVar("ra_arrived")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *письмо поступления*
Public Property Let strRaArrived(ByVal strRaArrivedNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *письмо поступления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_arrived", strRaArrivedNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *письмо поступления*. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата письма поступления*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата письма поступления*
Public Property Get dateRaArrivedDate() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата письма поступления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaArrivedDate = readFieldVar("ra_arrived_date")

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *дата письма поступления*
Public Property Let dateRaArrivedDate(ByVal dateRaArrivedDateNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата письма поступления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_arrived_date", dateRaArrivedDateNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата письма поступления*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата письма поступления фактическая*. 21.07.2022
' геттер свойства *дата письма поступления фактическая* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get dateRaArrivedDateFact() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата письма поступления фактическая*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaArrivedDateFact = readFieldVar("ra_arrived_dateFact")

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' леттер свойства *дата письма поступления фактическая* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Let dateRaArrivedDateFact(ByVal dateRaArrivedDateFactNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата письма поступления фактическая*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_arrived_dateFact", dateRaArrivedDateFactNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата письма поступления фактическая*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' группа свойств *письмо поступления*. Окончание
' ===================================================================================================================================================

' ===================================================================================================================================================
' группа свойств *письмо возвращения*
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *письмо возвращения*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *письмо возвращения*
Public Property Get strRaReturned() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *письмо возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaReturned = readFieldVar("ra_returned")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *письмо возвращения*
Public Property Let strRaReturned(ByVal strRaReturnedNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *письмо возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_returned", strRaReturnedNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *письмо возвращения*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата письма возвращения*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата письма возвращения*
Public Property Get dateRaReturnedDate() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата письма возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaReturnedDate = readFieldVar("ra_returned_date")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *дата письма возвращения*
Public Property Let dateRaReturnedDate(ByVal dateRaReturnedDateNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата письма возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_returned_date", dateRaReturnedDateNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата письма возвращения*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *причина возвращения*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *причина возвращения*
Public Property Get strRaReturnedReason() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *причина возвращения*."
On Error GoTo ErrHandler

    strRaReturnedReason = readFieldVar("ra_returnedReason")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *причина возвращения*
Public Property Let strRaReturnedReason(ByVal strRaReturnedReasonNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *причина возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_returnedReason", strRaReturnedReasonNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *причина возвращения*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' группа свойств *письмо возвращения*. Окончание
' ===================================================================================================================================================

' ===================================================================================================================================================
' группа свойств *письмо направления*
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *письмо направления*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *письмо направления*
Public Property Get strRaSent() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *письмо направления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaSent = readFieldVar("ra_sent")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *письмо направления*
Public Property Let strRaSent(ByVal strRaSentNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *письмо направления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler
    
    editFieldStr "ra_sent", strRaSentNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *письмо направления*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата письма направления*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата письма направления*
Public Property Get dateRaSentDate() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата письма направления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaSentDate = readFieldVar("ra_sent_date")
    
NormalExit:
    Exit Property
    
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
    
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' леттер свойства *дата письма направления* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Let dateRaSentDate(ByVal dateRaSentDateNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата письма направления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_sent_date", dateRaSentDateNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата письма направления*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' группа свойств *письмо направления*. Окончание
' ===================================================================================================================================================

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *организация отправитель*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *организация отправитель*
Public Property Get lngRaSender() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *организация отправитель*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    lngRaSender = readFieldVar("ra_org_sender")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *организация отправитель*
Public Property Let lngRaSender(ByVal lngRaSenderNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *организация отправитель*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' отправителя не может быть с ключём 0, можем только сделать запись пустой
    ' равно ли новое значение 0?
    If lngRaSenderNew = 0 Then
        ' да, новое значение равно 0
        editFieldNum "ra_org_sender", Null
    Else
        ' нет, новое значение не равно 0
        editFieldNum "ra_org_sender", lngRaSenderNew
    End If
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *организация отправитель*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата отчёта агента*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата отчёта агента*
Public Property Get dateRaDate() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата отчёта агента*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaDate = readFieldVar("ra_date")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *дата отчёта агента*
Public Property Let dateRaDate(ByVal dateRaDateNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата отчёта агента*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_date", dateRaDateNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата отчёта агента*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *имя отчёта строчное*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *имя отчёта строчное*
Public Property Get strRaName() As String
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *имя отчёта строчное*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    If mlngRaKey > 0 Then
        strRaName = Me.strRaNum & IIf(IsNull(Me.dateRaDate), "", " от " & Me.dateRaDate)
    Else
        strRaName = "Ошибка. Объект отчёта не определен!"
    End If
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *имя отчёта строчное*. 22.07.2022. Окончание
' геттеры и сеттеры (леттеры) свойств. Окончание
' ###################################################################################################################################################

' ###################################################################################################################################################
' инициализации и реинициализации
' ***************************************************************************************************************************************************
' обработка встроенного события инициализации
Private Sub Class_Initialize()
    ' инициализируем объект с нулевым ключём. В таком виде он не имеет смысла.
    ' Требуется реинициализация.
    ' -1 означает, что проверки наличия свойства не было. Если позже будет установлено значение свойства,
    ' то оно будет приведено к 0 при отсутствии и к значению при наличии.
    ' Это чтобы избежать необходимости каждый раз вычислять свойство заново
    mlngRaKey = -1
End Sub
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' реинициализируем объект *Отчёт агента* по известному ключу такого объекта. 18.07.2022
' ...................................................................................................................................................
Public Sub Class_ReinitialiseByKey(ByVal raKey As Long, ByRef boResult As Boolean, db As DAO.Database)
    ' ...............................................................................................................................................
    Dim rsRa As DAO.Recordset, strSql As String
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String _
        = "Процедура *Реинициализируем объект *Отчёт агента* по известному ключу такого объекта*."
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' ключ объекта равен -1? То есть реинициализация ранее не проводилась
    If mlngRaKey = -1 Then
        ' да,ключ объекта равен -1
        ' отыскиваем объект по известному ключу
        strSql = "SELECT * FROM ags_ra AS r WHERE ra_key = " & raKey & ";"
        Set rsRa = db.OpenRecordset(strSql, dbOpenSnapshot)
        
        ' имеются ли записи с указанным ключём?
        If rsRa.RecordCount = 1 Then
            ' да, записи с указанным ключём имеются
            mlngRaKey = raKey
            Set mdbDb = db ' устанавливаем ссылку на базу данных
            boResult = True ' результат положительный
        Else
            ' нет, записи с указанным ключём отсутствуют
            mlngRaKey = 0
            boResult = False ' результат отрицательный
        End If
    Else
        ' да,ключ объекта не равен -1
        ' ключ объекта равен 0?
        If mlngRaKey = 0 Then
            ' да, ключ объекта равен 0. Ранее он безуспешно реинициализировался
            boResult = False
        Else
            ' нет, ключ объекта не равен 0. Ранее он успешно реинициализировался
            boResult = True
        End If
    End If
    
    ' закрываем набор записей
    rsRa.Close: Set rsRa = Nothing
    
NormalExit:
    Exit Sub
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Sub
' реинициализируем объект *Отчёт агента* по известному ключу такого объекта. 18.07.2022. Окончание **************************************************
' ***************************************************************************************************************************************************


' ***************************************************************************************************************************************************
' реинициализируем объект *Отчёт агента* путём создания нового такого объекта. 21.07.2022
' ...................................................................................................................................................
Public Sub Class_ReinitialiseCreateNew(ByRef boResult As Boolean, ByRef db As DAO.Database, _
    ByVal strRaNum As String, ByVal strRaSign As String, ByVal lngRaPeriod As Long, ByVal lngRaCstAgPn As Long, ByVal lngRaOgSender As Long, _
    ByVal varRaDate As Variant, ByVal varRaWorkType As Variant, _
    ByVal varRaArrv As Variant, ByVal varRaArrvDate As Variant, ByVal varRaArrvDateFact As Variant, _
    ByVal varRaRtnd As Variant, ByVal varRaRtndDate As Variant, ByVal varRaRtndReason As Variant, _
    ByVal varRaSent As Variant, ByVal varRaSentDate As Variant, _
    ByVal varRaNoteT As Variant, ByVal varRaNote As Variant)
    ' ...............................................................................................................................................
    Dim rs As DAO.Recordset, strSql As String, raType As String, raKeyNew As Long, strTest As String
    ' ...............................................................................................................................................
    Const cstrTitle As String = "Процедура *Реинициализируем объект *Отчёт агента* путём создания нового такого объекта*."
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' ключ объекта равен -1? То есть реинициализация ранее не проводилась
    If mlngRaKey = -1 Then
        ' да, ключ объекта равен -1
        ' создаём новый объект
        raType = IIf(strRaSign = "ОА прочие", "ОА, прочие", strRaSign) ' уточняем тип отчёта
        Set rs = db.OpenRecordset("ags_ra", dbOpenDynaset, dbFailOnError + dbSeeChanges) ' открываем набор записей для добавления
        With rs
            .AddNew
                !ra_num = strRaNum
                !ra_type = raType
                !ra_period = lngRaPeriod
                !ra_cac = lngRaCstAgPn
                !ra_org_sender = lngRaOgSender
            .Update
            .Bookmark = .LastModified
            raKeyNew = !ra_key
        End With
        ' имеется ли новый ключ?
        If raKeyNew > 0 Then
            ' да, новый ключ имеется
            mlngRaKey = raKeyNew
            ' устанавливаем ссылку на базу данных
            Set mdbDb = db
            
            ' записываем значения
            If IsDate(varRaDate) Then
                Me.dateRaDate = varRaDate
            End If
            
            If Not IsNull(varRaWorkType) Then
                strTest = CStr(varRaWorkType)
                If strTest <> "" Then
                    Me.strRaTypeWork = strTest
                End If
            End If
            
            If Not IsNull(varRaArrv) Then
                strTest = CStr(varRaArrv)
                If strTest <> "" Then
                    Me.strRaArrived = strTest
                End If
            End If
            
            If IsDate(varRaArrvDate) Then
                Me.dateRaArrivedDate = varRaArrvDate
            End If
            
            If IsDate(varRaArrvDateFact) Then
                Me.dateRaArrivedDateFact = varRaArrvDateFact
            End If
            
            If Not IsNull(varRaRtnd) Then
                strTest = CStr(varRaRtnd)
                If strTest <> "" Then
                    Me.strRaReturned = strTest
                End If
            End If
            
            If IsDate(varRaRtndDate) Then
                Me.dateRaReturnedDate = varRaRtndDate
            End If
            
            If Not IsNull(varRaRtndReason) Then
                strTest = CStr(varRaRtndReason)
                If strTest <> "" Then
                    Me.strRaReturnedReason = strTest
                End If
            End If
            
            If Not IsNull(varRaSent) Then
                strTest = CStr(varRaSent)
                If strTest <> "" Then
                    Me.strRaSent = strTest
                End If
            End If
            
            If IsDate(varRaSentDate) Then
                Me.dateRaSentDate = varRaSentDate
            End If
            
            If Not IsNull(varRaNoteT) Then
                strTest = CStr(varRaNoteT)
                If strTest <> "" Then
                    Me.strRaNoteT = strTest
                End If
            End If
            
            If Not IsNull(varRaNote) Then
                strTest = CStr(varRaNote)
                If strTest <> "" Then
                    Me.strRaNote = strTest
                End If
            End If
            
            ' результат положительный
            boResult = True
        Else
            ' нет, новый ключ отсутствует
            mlngRaKey = 0
            ' результат отрицательный
            boResult = False
        End If ' имеется ли новый ключ?
    Else
        ' нет, ключ объекта не равен -1
        ' ключ объекта равен 0?
        If mlngRaKey = 0 Then
            ' да, ключ объекта равен 0. Ранее он безуспешно реинициализировался
            boResult = False
        Else
            ' нет, ключ объекта не равен 0. Ранее он успешно реинициализировался
            boResult = True
        End If
    End If ' ключ объекта равен -1? То есть реинициализация ранее не проводилась
    
    rs.Close: Set rs = Nothing ' закрываем набор записей
    
NormalExit:
    Exit Sub
ErrHandler:
    ' не удалось вставить запись?
    If Err.Number = 3146 Then
        ' да, не удалось вставить запись
        boResult = False
        rs.Close: Set rs = Nothing ' закрываем набор записей
    Else
        ' нет, со вставкой записи не связано. Какая то другая ошибка
        MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    End If
    Resume NormalExit
End Sub
' реинициализируем объект *Отчёт агента* путём создания нового такого объекта. 21.07.2022. Окончание
' ***************************************************************************************************************************************************
' инициализации и реинициализации. Окончание
' ###################################################################################################################################################


' ***************************************************************************************************************************************************
' добавляем объекту *Отчёт агента* объект *Сумма отчёта агента* путём создания нового такого объекта. 21.07.2022
' ...................................................................................................................................................
Public Function rasmRaSmAdd(ByVal varTtl As Variant, ByVal varWork As Variant, ByVal varEquip As Variant, ByVal varOthers As Variant) As raSm
    ' ...............................................................................................................................................
    ' Dim rsRa As DAO.Recordset, strSql As String
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String _
        = "Процедура *Добавляем объекту *Отчёт агента* объект *Сумма отчёта агента* путём создания нового такого объекта*."
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' ключ объекта больше 0?
    If mlngRaKey > 0 Then
        ' да, ключ объекта больше 0
        Set rasmRaSmAdd = ClassFactory.raSmCreateNew(mlngRaKey, mdbDb, varTtl, varWork, varEquip, varOthers)
    Else
        ' нет, ключ объекта меньше или равен 0
        Set rasmRaSmAdd = Nothing
    End If
    
NormalExit:
    Exit Function
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Function
' добавляем объекту *Отчёт агента* объект *Сумма отчёта агента* путём создания нового такого объекта. 21.07.2022. Окончание
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' удаляем объект *Отчёт агента*. 25.07.2022
' ...................................................................................................................................................
Public Sub raDelete()
    ' ...............................................................................................................................................
    ' Dim rs As DAO.Recordset, strSql As String
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String _
        = "Процедура *Удаляем объект *Отчёт агента*."
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' ключ объекта больше 0?
    If mlngRaKey > 0 Then
        ' да, ключ объекта больше 0
        strSql = "delete * from ags_ra where ra_key = " & mlngRaKey
        mdbDb.Execute strSql, dbFailOnError + dbSeeChanges
        mlngRaKey = 0
    End If
    
NormalExit:
    Exit Sub
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Sub
' удаляем объект *Отчёт агента*. 25.07.2022. Окончание
' ***************************************************************************************************************************************************

' ###################################################################################################################################################
' чтение полей и запись в них
' ***************************************************************************************************************************************************
' редактируем строковое поле. 19.07.2022
Private Sub editFieldStr(ByVal strFieldName As String, ByVal strNew As Variant)

    ClassFunc.varEditFieldStr strFieldName, strNew, "ags_ra", mlngRaKey, "ra_key", mdbDb
    
End Sub
' редактируем строковое поле. 19.07.2022. Окончание
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' читаем значение поля в переменную типа Variant. 20.07.2022
Private Function readFieldVar(ByVal dateFieldName As String) As Variant
    
    readFieldVar = ClassFunc.varReadField(dateFieldName, "ags_ra", mlngRaKey, "ra_key", mdbDb)
    
End Function
' читаем значение поля в переменную типа Variant. 20.07.2022. Окончание
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' редактируем поле даты. 20.07.2022
Private Sub editFieldDate(ByVal dateFieldName As String, ByVal dateNew As Variant)
    
    ClassFunc.varEditFieldDate dateFieldName, dateNew, "ags_ra", mlngRaKey, "ra_key", mdbDb
    
End Sub
' редактируем поле даты. 20.07.2022. Окончание
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' редактируем числовое поле. 20.07.2022
Private Sub editFieldNum(ByVal numFieldName As String, ByVal numNew As Variant)
    
    ClassFunc.varEditFieldNum numFieldName, numNew, "ags_ra", mlngRaKey, "ra_key", mdbDb
    
End Sub
' редактируем числовое поле. 20.07.2022. Окончание
' ***************************************************************************************************************************************************
' чтение полей и запись в них. Окончание
' ###################################################################################################################################################

