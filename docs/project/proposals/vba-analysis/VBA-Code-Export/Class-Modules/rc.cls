VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "rc"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Compare Database

' объект *Изменение отчёта агента* 22.07.2022

' ###################################################################################################################################################
' область определения закрытых пременных, содержащих значения свойств ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' !!! не нужно их писать в других местах, это приведет к ошибке. 07.07.2022
' ключ объекта #Изменение отчёта агента#
Private mlngRсKey As Long
' база данных
Private mdbDb As DAO.Database
' область определения закрытых пременных, содержащих значения свойств ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' ###################################################################################################################################################

' ###################################################################################################################################################
' геттеры и сеттеры (леттеры) свойств


' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *ключ объекта #Изменение отчёта агента#*. 25.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *ключ объекта #Отчёт агента#* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get lngRcKey() As Long
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    lngRcKey = mlngRсKey
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *ключ объекта #Изменение отчёта агента#*. 25.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *ключ отчёта агента, к которому выпущено изменение*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *ключ отчёта агента, к которому выпущено изменение*
Public Property Get lngRcRa() As Long
    Const cstrTitle As String = "Процедура *Геттер свойства *ключ отчёта агента, к которому выпущено изменение*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    lngRcRa = readFieldVar("raс_ra")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *ключ отчёта агента, к которому выпущено изменение*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *объект отчёта агента, к которому выпущено изменение*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *объект отчёта агента, к которому выпущено изменение* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get raRcRa() As ra
    Const cstrTitle As String = "Процедура *Геттер свойства *объект отчёта агента, к которому выпущено изменение*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    If mlngRсKey > 0 Then
        Set raRcRa = ClassFactory.raByKey(Me.lngRcRa, mdbDb)
    Else
        Set raRcRa = Nothing
    End If
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *объект отчёта агента, к которому выпущено изменение*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *номер изменения*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *номер изменения* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get lngRcNum() As Long
    Const cstrTitle As String = "Процедура *Геттер свойства *номер изменения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    lngRcNum = readFieldVar("raс_num")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *номер изменения*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата изменения*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата изменения*
Public Property Get dateRcDate() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата изменения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRcDate = readFieldVar("raс_date")

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *дата изменения*
Public Property Let dateRcDate(ByVal dateRcDateNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата изменения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "raс_date", dateRcDateNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата изменения*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



' ===================================================================================================================================================
' группа свойств *письмо поступления*
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *письмо поступления*
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *письмо поступления*
Public Property Get strRaArrived() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *письмо поступления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaArrived = readFieldVar("ra_arrived")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *письмо поступления*
Public Property Let strRaArrived(ByVal strRaArrivedNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *письмо поступления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_arrived", strRaArrivedNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *письмо поступления*. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата письма поступления*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата письма поступления*
Public Property Get dateRaArrivedDate() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата письма поступления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaArrivedDate = readFieldVar("ra_arrived_date")

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *дата письма поступления*
Public Property Let dateRaArrivedDate(ByVal dateRaArrivedDateNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата письма поступления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_arrived_date", dateRaArrivedDateNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата письма поступления*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата письма поступления фактическая*. 21.07.2022
' геттер свойства *дата письма поступления фактическая* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get dateRaArrivedDateFact() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата письма поступления фактическая*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaArrivedDateFact = readFieldVar("ra_arrived_dateFact")

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' леттер свойства *дата письма поступления фактическая* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Let dateRaArrivedDateFact(ByVal dateRaArrivedDateFactNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата письма поступления фактическая*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_arrived_dateFact", dateRaArrivedDateFactNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата письма поступления фактическая*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' группа свойств *письмо поступления*. Окончание
' ===================================================================================================================================================


' ===================================================================================================================================================
' группа свойств *письмо возвращения*
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *письмо возвращения*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *письмо возвращения*
Public Property Get strRaReturned() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *письмо возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaReturned = readFieldVar("ra_returned")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *письмо возвращения*
Public Property Let strRaReturned(ByVal strRaReturnedNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *письмо возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_returned", strRaReturnedNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *письмо возвращения*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата письма возвращения*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата письма возвращения*
Public Property Get dateRaReturnedDate() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата письма возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaReturnedDate = readFieldVar("ra_returned_date")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *дата письма возвращения*
Public Property Let dateRaReturnedDate(ByVal dateRaReturnedDateNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата письма возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_returned_date", dateRaReturnedDateNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата письма возвращения*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *причина возвращения*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *причина возвращения*
Public Property Get strRaReturnedReason() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *причина возвращения*."
On Error GoTo ErrHandler

    strRaReturnedReason = readFieldVar("ra_returnedReason")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *причина возвращения*
Public Property Let strRaReturnedReason(ByVal strRaReturnedReasonNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *причина возвращения*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_returnedReason", strRaReturnedReasonNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *причина возвращения*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' группа свойств *письмо возвращения*. Окончание
' ===================================================================================================================================================



' ===================================================================================================================================================
' группа свойств *письмо направления*
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *письмо направления*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *письмо направления*
Public Property Get strRaSent() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *письмо направления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaSent = readFieldVar("ra_sent")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *письмо направления*
Public Property Let strRaSent(ByVal strRaSentNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *письмо направления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler
    
    editFieldStr "ra_sent", strRaSentNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *письмо направления*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата письма направления*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата письма направления*
Public Property Get dateRaSentDate() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *дата письма направления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaSentDate = readFieldVar("ra_sent_date")
    
NormalExit:
    Exit Property
    
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
    
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' леттер свойства *дата письма направления* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Let dateRaSentDate(ByVal dateRaSentDateNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *дата письма направления*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldDate "ra_sent_date", dateRaSentDateNew
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата письма направления*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' группа свойств *письмо направления*. Окончание
' ===================================================================================================================================================


' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *организация отправитель*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *организация отправитель* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get lngRaSender() As Variant
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Геттер свойства *организация отправитель*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    lngRaSender = readFieldVar("ra_org_sender")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' леттер свойства *организация отправитель* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Let lngRaSender(ByVal lngRaSenderNew As Variant)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Леттер свойства *организация отправитель*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' отправителя не может быть с ключём 0, можем только сделать запись пустой
    ' равно ли новое значение 0?
    If lngRaSenderNew = 0 Then
        ' да, новое значение равно 0
        editFieldNum "ra_org_sender", Null
    Else
        ' нет, новое значение не равно 0
        editFieldNum "ra_org_sender", lngRaSenderNew
    End If
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *организация отправитель*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *примечания временные, про создание*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *примечания временные, про создание*
Public Property Get strRaNoteT() As Variant
    Const cstrTitle As String = "Процедура *Геттер свойства *примечания временные, про создание*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaNoteT = readFieldVar("ra_note_t")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *примечания временные, про создание*
Public Property Let strRaNoteT(ByVal strRaNoteTNew As Variant)
    Const cstrTitle As String = "Процедура *Леттер свойства *примечания временные, про создание*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_note_t", strRaNoteTNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *примечания временные, про создание*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *дата создания отчёта в БД*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *дата создания отчёта в БД* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get dateRaCreated() As Variant
    Const cstrTitle As String = "Процедура *Геттер свойства *дата создания отчёта в БД*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    dateRaCreated = readFieldVar("ra_created")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *дата создания отчёта в БД*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *примечания*. 21.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *примечания*
Public Property Get strRaNote() As Variant
    Const cstrTitle As String = "Процедура *Геттер свойства *примечания*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    strRaNote = readFieldVar("ra_note")
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' леттер свойства *примечания*
Public Property Let strRaNote(ByVal strRaNoteNew As Variant)
    Const cstrTitle As String = "Процедура *Леттер свойства *примечания*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    editFieldStr "ra_note", strRaNoteNew

NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *примечания*. 21.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



'' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
'' свойство *дата изменения отчёта агента*. 22.07.2022
'' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'' геттер свойства *дата изменения отчёта агента*
'Public Property Get dateRcDate() As Variant
'    ' -----------------------------------------------------------------------------------------------------------------------------------------------
'    Const cstrTitle As String = "Процедура *Геттер свойства *дата отчёта агента*."
'    ' -----------------------------------------------------------------------------------------------------------------------------------------------
'On Error GoTo ErrHandler
'
'    dateRaDate = readFieldVar("raс_date")
'
'NormalExit:
'    Exit Property
'ErrHandler:
'    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
'    Resume NormalExit
'End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'
'' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'' леттер свойства *дата изменения отчёта агента*
'Public Property Let dateRcDate(ByVal dateRcDateNew As Variant)
'    ' -----------------------------------------------------------------------------------------------------------------------------------------------
'    Const cstrTitle As String = "Процедура *Леттер свойства *дата отчёта агента*."
'    ' -----------------------------------------------------------------------------------------------------------------------------------------------
'On Error GoTo ErrHandler
'
'    editFieldDate "raс_date", dateRcDateNew
'
'NormalExit:
'    Exit Property
'ErrHandler:
'    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
'    Resume NormalExit
'End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'' свойство *дата изменения отчёта агента*. 22.07.2022. Окончание
'' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++



' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' свойство *имя изменения строчное*. 22.07.2022
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' геттер свойства *номер изменения* '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Property Get strRcName() As String
    Const cstrTitle As String = "Процедура *Геттер свойства *имя изменения строчное*."
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    If mlngRсKey > 0 Then
        strRcName = "Изм. № " & Me.lngRcNum & IIf(IsNull(Me.dateRcDate), "", " от " & Me.dateRcDate) & " к " & Me.raRcRa.strRaName
    Else
        strRcName = "Ошибка. Объект изменения не определен!"
    End If
    
NormalExit:
    Exit Property
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Property ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' свойство *имя изменения строчное*. 22.07.2022. Окончание
' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
' геттеры и сеттеры (леттеры) свойств. Окончание
' ###################################################################################################################################################


' ###################################################################################################################################################
' инициализации и реинициализации
' ***************************************************************************************************************************************************
' обработка встроенного события инициализации
Private Sub Class_Initialize()
    ' инициализируем объект с нулевым ключём. В таком виде он не имеет смысла.
    ' Требуется реинициализация.
    ' -1 означает, что проверки наличия свойства не было. Если позже будет установлено значение свойства,
    ' то оно будет приведено к 0 при отсутствии и к значению при наличии.
    ' Это чтобы избежать необходимости каждый раз вычислять свойство заново
    mlngRсKey = -1
End Sub
' ***************************************************************************************************************************************************


' ***************************************************************************************************************************************************
' реинициализируем объект *Изменение отчёта агента* по известному ключу такого объекта. 22.07.2022
' ...................................................................................................................................................
Public Sub Class_ReinitialiseByKey(ByVal rсKey As Long, ByRef boResult As Boolean, db As DAO.Database)
    ' ...............................................................................................................................................
    Dim rs As DAO.Recordset, strSql As String
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Реинициализируем объект *Изменение отчёта агента* по известному ключу такого объекта*."
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' ключ объекта равен -1? То есть реинициализация ранее не проводилась
    If mlngRсKey = -1 Then
        ' да,ключ объекта равен -1
        ' отыскиваем объект по известному ключу
        strSql = "SELECT * FROM ags_ra_change AS r WHERE rac_key = " & rсKey & ";"
        Set rs = db.OpenRecordset(strSql, dbOpenSnapshot)
        
        ' имеются ли записи с указанным ключём?
        If rs.RecordCount = 1 Then
            ' да, записи с указанным ключём имеются
            mlngRсKey = rсKey
            Set mdbDb = db ' устанавливаем ссылку на базу данных
            boResult = True ' результат положительный
        Else
            ' нет, записи с указанным ключём отсутствуют
            mlngRсKey = 0
            boResult = False ' результат отрицательный
        End If
    Else
        ' да,ключ объекта не равен -1
        ' ключ объекта равен 0?
        If mlngRсKey = 0 Then
            ' да, ключ объекта равен 0. Ранее он безуспешно реинициализировался
            boResult = False
        Else
            ' нет, ключ объекта не равен 0. Ранее он успешно реинициализировался
            boResult = True
        End If
    End If
    
    ' закрываем набор записей
    rs.Close: Set rs = Nothing
    
NormalExit:
    Exit Sub
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Sub
' реинициализируем объект *Изменение отчёта агента* по известному ключу такого объекта. 22.07.2022. Окончание
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' реинициализируем объект *Изменение отчёта агента* путём создания нового такого объекта. 25.07.2022
' ...................................................................................................................................................
Public Sub Class_ReinitialiseCreateNew(ByRef boResult As Boolean, ByRef db As DAO.Database, _
    ByVal lngRcRa As Long, ByVal intRcNum As Integer, ByVal lngRcPeriod As Long, ByVal lngRcOgSender As Long, _
    ByVal varRcDate As Variant, _
    ByVal varRaArrv As Variant, ByVal varRaArrvDate As Variant, ByVal varRaArrvDateFact As Variant, _
    ByVal varRaRtnd As Variant, ByVal varRaRtndDate As Variant, ByVal varRaRtndReason As Variant, _
    ByVal varRaSent As Variant, ByVal varRaSentDate As Variant, _
    ByVal varRaNoteT As Variant, ByVal varRaNote As Variant)
    ' ...............................................................................................................................................
    Dim rs As DAO.Recordset, strSql As String, rcKeyNew As Long, strTest As String
    ' ...............................................................................................................................................
    Const cstrTitle As String = "Процедура *Реинициализируем объект *Изменение отчёта агента* путём создания нового такого объекта*."
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' ключ объекта равен -1? То есть реинициализация ранее не проводилась
    If mlngRсKey = -1 Then
        ' да, ключ объекта равен -1
        ' создаём новый объект
        Set rs = db.OpenRecordset("ags_ra_change", dbOpenDynaset, dbFailOnError + dbSeeChanges) ' открываем набор записей для добавления
        With rs
            .AddNew
                !raс_ra = lngRcRa
                !raс_num = intRcNum
                !ra_period = lngRcPeriod
                !ra_org_sender = lngRcOgSender
            .Update
            .Bookmark = .LastModified
            rcKeyNew = !rac_key
        End With
        ' имеется ли новый ключ?
        If rcKeyNew > 0 Then
            ' да, новый ключ имеется
            mlngRсKey = rcKeyNew
            ' устанавливаем ссылку на базу данных
            Set mdbDb = db
            
            ' записываем значения
            If IsDate(varRcDate) Then
                Me.dateRcDate = varRcDate
            End If
            
            If Not IsNull(varRaArrv) Then
                strTest = CStr(varRaArrv)
                If strTest <> "" Then
                    Me.strRaArrived = strTest
                End If
            End If
            
            If IsDate(varRaArrvDate) Then
                Me.dateRaArrivedDate = varRaArrvDate
            End If
            
            If IsDate(varRaArrvDateFact) Then
                Me.dateRaArrivedDateFact = varRaArrvDateFact
            End If
            
            If Not IsNull(varRaRtnd) Then
                strTest = CStr(varRaRtnd)
                If strTest <> "" Then
                    Me.strRaReturned = strTest
                End If
            End If
            
            If IsDate(varRaRtndDate) Then
                Me.dateRaReturnedDate = varRaRtndDate
            End If
            
            If Not IsNull(varRaRtndReason) Then
                strTest = CStr(varRaRtndReason)
                If strTest <> "" Then
                    Me.strRaReturnedReason = strTest
                End If
            End If
            
            If Not IsNull(varRaSent) Then
                strTest = CStr(varRaSent)
                If strTest <> "" Then
                    Me.strRaSent = strTest
                End If
            End If
            
            If IsDate(varRaSentDate) Then
                Me.dateRaSentDate = varRaSentDate
            End If
            
            If Not IsNull(varRaNoteT) Then
                strTest = CStr(varRaNoteT)
                If strTest <> "" Then
                    Me.strRaNoteT = strTest
                End If
            End If

            If Not IsNull(varRaNote) Then
                strTest = CStr(varRaNote)
                If strTest <> "" Then
                    Me.strRaNote = strTest
                End If
            End If
            
            rs.Close: Set rs = Nothing ' закрываем набор записей
            
            ' результат положительный
            boResult = True
        Else
            ' нет, новый ключ отсутствует
            mlngRсKey = 0
            ' результат отрицательный
            boResult = False
        End If ' имеется ли новый ключ?
    Else
        ' нет, ключ объекта не равен -1
        ' ключ объекта равен 0?
        If mlngRсKey = 0 Then
            ' да, ключ объекта равен 0. Ранее он безуспешно реинициализировался
            boResult = False
        Else
            ' нет, ключ объекта не равен 0. Ранее он успешно реинициализировался
            boResult = True
        End If
    End If ' ключ объекта равен -1? То есть реинициализация ранее не проводилась
    
NormalExit:
    Exit Sub
ErrHandler:
    ' не удалось вставить запись?
    If Err.Number = 3146 Then
        ' да, не удалось вставить запись
        boResult = False
        rs.Close: Set rs = Nothing ' закрываем набор записей
    Else
        ' нет, со вставкой записи не связано. Какая то другая ошибка
        MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    End If
    Resume NormalExit
End Sub
' реинициализируем объект *Изменение отчёта агента* путём создания нового такого объекта. 25.07.2022. Окончание
' ***************************************************************************************************************************************************
' инициализации и реинициализации. Окончание
' ###################################################################################################################################################



' ***************************************************************************************************************************************************
' добавляем объекту *Изменение отчёта агента* объект *Сумма изменения отчёта агента* путём создания нового такого объекта. 25.07.2022
' ...................................................................................................................................................
Public Function rcsmRcSmAdd(ByVal varTtl As Variant, ByVal varWork As Variant, ByVal varEquip As Variant, ByVal varOthers As Variant) As rcSm
    ' ...............................................................................................................................................
    ' Dim rs As DAO.Recordset, strSql As String
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String _
        = "Процедура *Добавляем объекту *Изменение отчёта агента* объект *Сумма изменения отчёта агента* путём создания нового такого объекта*."
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' ключ объекта больше 0?
    If mlngRсKey > 0 Then
        ' да, ключ объекта больше 0
        Set rcsmRcSmAdd = ClassFactory.rcSmCreateNew(mlngRсKey, mdbDb, varTtl, varWork, varEquip, varOthers)
    Else
        ' нет, ключ объекта меньше или равен 0
        Set rcsmRcSmAdd = Nothing
    End If
    
NormalExit:
    Exit Function
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Function
' добавляем объекту *Изменение отчёта агента* объект *Сумма изменения отчёта агента* путём создания нового такого объекта. 25.07.2022. Окончание
' ***************************************************************************************************************************************************


' ***************************************************************************************************************************************************
' удаляем объект *Изменение отчёта агента*. 25.07.2022
' ...................................................................................................................................................
Public Sub rcDelete()
    ' ...............................................................................................................................................
    ' Dim rs As DAO.Recordset, strSql As String
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Удаляем объект *Изменение отчёта агента*."
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler

    ' ключ объекта больше 0?
    If mlngRсKey > 0 Then
        ' да, ключ объекта больше 0
        strSql = "delete * from ags_ra_change where rac_key = " & mlngRсKey
        mdbDb.Execute strSql, dbFailOnError + dbSeeChanges
        mlngRсKey = 0
    End If
    
NormalExit:
    Exit Sub
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle: Resume NormalExit
End Sub
' удаляем объект *Изменение отчёта агента*. 25.07.2022. Окончание
' ***************************************************************************************************************************************************


' ###################################################################################################################################################
' чтение полей и запись в них
' ***************************************************************************************************************************************************
' редактируем строковое поле. 22.07.2022
Private Sub editFieldStr(ByVal strFieldName As String, ByVal strNew As Variant)

    ClassFunc.varEditFieldStr strFieldName, strNew, "ags_ra_change", mlngRсKey, "rac_key", mdbDb
    
End Sub
' редактируем строковое поле. 22.07.2022. Окончание
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' читаем значение поля в переменную типа Variant. 22.07.2022
Private Function readFieldVar(ByVal dateFieldName As String) As Variant
    
    readFieldVar = ClassFunc.varReadField(dateFieldName, "ags_ra_change", mlngRсKey, "rac_key", mdbDb)
    
End Function
' читаем значение поля в переменную типа Variant. 22.07.2022. Окончание
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' редактируем поле даты. 22.07.2022
Private Sub editFieldDate(ByVal dateFieldName As String, ByVal dateNew As Variant)
    
    ClassFunc.varEditFieldDate dateFieldName, dateNew, "ags_ra_change", mlngRсKey, "rac_key", mdbDb
    
End Sub
' редактируем поле даты. 22.07.2022. Окончание
' ***************************************************************************************************************************************************

' ***************************************************************************************************************************************************
' редактируем числовое поле. 22.07.2022
Private Sub editFieldNum(ByVal numFieldName As String, ByVal numNew As Variant)
    
    ClassFunc.varEditFieldNum numFieldName, numNew, "ags_ra_change", mlngRсKey, "rac_key", mdbDb
    
End Sub
' редактируем числовое поле. 22.07.2022. Окончание
' ***************************************************************************************************************************************************
' чтение полей и запись в них. Окончание
' ###################################################################################################################################################


