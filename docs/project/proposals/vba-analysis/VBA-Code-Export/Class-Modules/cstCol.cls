VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "cstCol"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Compare Database

' класс *Коллекция строек*. 26.07.2023

' ###################################################################################################################################################
' область определения закрытых пременных, содержащих значения свойств ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' !!! не нужно их писать в других местах, это приведет к ошибке. 07.07.2022
' ключ пункта первичного документа
'Private mlngOgAgFeeKey As Long
' база данных
'Private mdbDb As DAO.Database
' область определения закрытых пременных, содержащих значения свойств ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
' ---------------------------------------------------------------------------------------------------------------------------------------------------
Const cstrTable As String = "ags_cst", cstrTableKeyField As String = "cstKey", cstrForm = "cst"
' ---------------------------------------------------------------------------------------------------------------------------------------------------
' ###################################################################################################################################################

' ###################################################################################################################################################
' методы

' ***************************************************************************************************************************************************
' процедура *Проверяем наличие стройки по выделенной последовательности символов*. 26.07.2023
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Sub cstTestWord(ByVal strFilter As String)
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Dim frmCst As Form_cst
    ' -----------------------------------------------------------------------------------------------------------------------------------------------
    Const cstrTitle As String = "Процедура *Коллекция строек. Проверяем наличие стройки по выделенной последовательности символов*"
' ---------------------------------------------------------------------------------------------------------------------------------------------------
On Error GoTo ErrHandler
' ---------------------------------------------------------------------------------------------------------------------------------------------------
    
    'MsgBox ("Процедура *Проверяем наличие стройки по выделенной последовательности символов*")
    If SysCmd(acSysCmdGetObjectState, acForm, cstrForm) <> 0 Then

       ' The object is open.
        'IsObjectLoaded = True
'        MsgBox ("Form *cst* is open")
    Else

       ' The object is not open.
        'IsObjectLoaded = False
        ' MsgBox ("Form *cst* not is open")
        DoCmd.OpenForm cstrForm, acNormal ', , "OrderID = " & OrderID
    End If
    
    'frmCst.Show
    
    Forms(cstrForm).FilterOn = False
    Forms(cstrForm).Filter = "cstName like '*" & strFilter & "*'"
    Forms(cstrForm).FilterOn = True
    Forms(cstrForm).Visible = True
'    Forms(cstrForm).Show
'    DoCmd.SelectObject acForm, cstrForm, True
'    RefreshDatabaseWindow
'    Screen..ActiveForm = Forms(cstrForm)

' ---------------------------------------------------------------------------------------------------------------------------------------------------
NormalExit:
    Exit Sub
ErrHandler:
    MsgBox Err.Description & vbCrLf & "Error number: " & Err.Number & vbCrLf & cstrTitle, vbExclamation, cstrTitle
    Resume NormalExit
' ---------------------------------------------------------------------------------------------------------------------------------------------------
End Sub
' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' процедура *Проверяем наличие стройки по выделенной последовательности символов*. 26.07.2023. Окончание
' ***************************************************************************************************************************************************

' методы. Окончание
' ###################################################################################################################################################

