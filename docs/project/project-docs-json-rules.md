# Правила ведения файла project-docs.json

**Версия:** 1.3.0  
**Дата создания:** 2025-10-08  
**Последнее обновление:** 2025-01-27

---

## Связанные документы

- **[Общие правила документации](../project-documentation-rules.md)** - правила ведения всей проектной документации
- **[Система структурной нумерации](../project-documentation-rules-structural-numbering.md)** - правила нумерации модулей, компонентов и классов
- **[Типы артефактов модулей](project-docs-json-rules-af-types.md)** - универсальный справочник типов артефактов для различных технологий
- **[Шаблон ADR](decisions/decision-template.md)** - шаблон для архитектурных решений

---

## О файле project-docs.json

**Назначение:** Центральный файл с описанием архитектуры, технологий, модулей и конфигурации проекта.

**Содержание:**
- Метаданные проекта
- Архитектурные решения
- Технологический стек
- Модули и их описание. В виде иерархической структуры модулей, компонентов и классов (базовая структура модуль-компонент-класс) с возможностью сворачивания ветвей с системой структурной нумерации (файл **project-documentation-rules-structural-numbering.md**). 
- Схема базы данных
- Конфигурация развертывания
- Временные рамки и риски
- Ресурсы и команда

**Правила ведения:**
- Обновляется при изменении архитектуры
- Содержит ссылки на ADR (Architectural Decision Records, Записи архитектурных решений), которые формируются, при необходимости, на основании шаблона **docs/project/decisions/decision-template.md**
- Включает ссылки на задачи разработки
- Версионируется при значительных изменениях

### Обновление project-docs.json
- При изменении архитектуры
- При добавлении новых модулей
- При изменении технологического стека
- При обновлении конфигурации развертывания
- При изменении временных рамок
- **При создании новых артефактов (классов, файлов конфигурации):**
  - **ОБЯЗАТЕЛЬНО** добавить в раздел `project.architecture.modules.list[N].components`
  - Указать тип компонента, ответственность, статус
  - Добавить классы в соответствующий компонент
  - Указать зависимости (`dependsOn`)
  - Для файлов конфигурации: добавить в список `files` компонента
  - Добавить ссылки из других разделов (stages, developmentObjects)
  - Пример: новый класс `ExampleMetricsClass` → добавить компонент `exsampleMetrics` в модуль `example`

## Структура расширений

### Организация файлов расширений
- **Папка extensions/** - содержит все расширения основного файла
- **Подпапки по разделам** - modules/, deployment/, database/, ui/, network/, monitoring/
- **Ссылки в разделах** - каждый раздел содержит массив `extensions` со ссылками на свои расширения

#### Иерархическая структура модулей
- **modules/** - общая папка для всех модулей проекта
- **modules/modules.json** - главный файл со ссылками на все модули
- **modules/backend/** - Backend модули с субмодулями
- **modules/frontend/** - Frontend модули
- **modules/backend/database/** - Database субмодуль с компонентами
- **modules/backend/web/** - Web API субмодуль
- **modules/backend/database/config/** - Config компонент с классами

#### Правила размещения ссылок
- **Ссылки на расширения** размещаются в том разделе, который они расширяют
- **Формат ссылок:** `"extensions": ["path/to/extension-file.json"]`
- **Обязательность:** расширения опциональны, но при их наличии ссылки обязательны
- **Иерархия модулей:** каждый уровень может ссылаться на свои расширения

### Правила работы с расширениями

#### Создание новых расширений
1. **Создать файл расширения** в соответствующей папке `extensions/[section]/`
2. **Добавить ссылку в основной файл** в раздел `[section].extensions`
3. **Обновить правила** при необходимости
4. **Документировать в журнале** создание расширения

#### Обновление расширений
- При изменении расширения - **НЕ ТРЕБУЕТСЯ** изменения основного файла
- При изменении структуры расширения - **ОБЯЗАТЕЛЬНО** обновить документацию
- При изменении имени файла - **ОБЯЗАТЕЛЬНО** обновить ссылку в основном файле

#### Удаление расширений
1. **Удалить файл расширения**
2. **Удалить ссылку** из соответствующего раздела
3. **Обновить документацию** при необходимости
4. **Задокументировать в журнале** удаление расширения

### Модульная структура расширений

#### Принцип организации модулей
- **Один файл для всех модулей** - `extensions/modules/modules.json`
- **Группировка атрибутов** - физические атрибуты в объекте `artifact`
- **Ссылочная целостность** - основной файл ссылается на `modules.json`
- **Рекурсивная структура** - Module → Module → Component → Component → Class

#### Структура файла модулей
```
modules/
├── modules-example.json            # Пример структуры модулей (шаблон)
└── modules.json                    # Реальные модули проекта
```

**Подробное описание типов артефактов и группировки `artifact`:** см. **[project-docs-json-rules-af-types.md](project-docs-json-rules-af-types.md)**

#### Правила создания модульных расширений
1. **Добавить артефакт** в файл `modules.json`
2. **Использовать группировку** - физические атрибуты в объект `artifact`
3. **Следовать рекурсивной структуре** - Module/Component/Class
4. **Обновить зависимости** в других артефактах
5. **Документировать в журнале** создание артефакта

#### Файл примера модулей

**Расположение:** `docs/project/extensions/modules/modules-example.json`

**Назначение:**
- Демонстрация структуры файла модулей
- Примеры рекурсивной вложенности с группировкой `artifact`
- Шаблон для создания нового проекта

**Использование:**
1. Скопируйте `modules-example.json` → `modules.json`
2. Замените примеры на реальные модули вашего проекта
3. Обновите нумерацию и атрибуты
4. Добавьте ссылку в `project-docs.json`

**Структура:** Один файл со всеми модулями проекта с группировкой физических атрибутов в `artifact`

### Контроль целостности ссылок (обновлено)

При добавлении расширения **ОБЯЗАТЕЛЬНО** проверить:
- ✅ Создан файл расширения в правильной папке
- ✅ Добавлена ссылка в соответствующий раздел основного файла
- ✅ Путь к файлу корректен и существует
- ✅ Структура расширения соответствует ожидаемой
- ✅ Документировано в журнале разработки

#### Контроль целостности модульных расширений
При добавлении модульного расширения **ОБЯЗАТЕЛЬНО** проверить:
- ✅ Создана правильная иерархия папок
- ✅ Создан JSON файл с корректной структурой
- ✅ Добавлена ссылка в родительский файл
- ✅ Обновлен главный файл modules.json
- ✅ Проверена целостность ссылок
- ✅ Документировано в журнале разработки
  
### Формат ID
- **Модуля (компонента, класса, иного артефакта структуры модулей):** 01.01.01.01 (иерархическая нумерация в соответствии с "Системой структурной нумерации" (файл **project-documentation-rules-structural-numbering.md**))
- **Элементы проекта:** project.architecture.backend.framework

### Рекурсивная иерархия модулей (Java/Spring)

#### Три базовые сущности

**1. Module (Модуль)**
- Может содержать: `modules[]`, `components[]`, `classes[]`
- Представляет: Maven modules, проекты, пакеты верхнего уровня
- Типы: maven-module, gradle-module, project-module

**2. Component (Компонент)**  
- Может содержать: `components[]`, `classes[]`
- Представляет: Java packages, пакеты, модули приложения
- Типы: java-package, vue-component, config-component

**3. Class (Класс)**
- Может содержать: `classes[]`
- Представляет: Java classes, interfaces, enums, вложенные классы
- Типы: java-class, java-interface, java-enum, nested-class

#### Рекурсивная структура

```
Module
├── modules[]           # Вложенные модули (Maven sub-modules)
│   ├── modules[]       # Модули в модуле (бесконечная вложенность)
│   ├── components[]    # Компоненты в модуле (Java packages)
│   └── classes[]       # Классы напрямую в модуле
├── components[]        # Компоненты напрямую в модуле
│   ├── components[]    # Субкомпоненты (вложенные пакеты)
│   └── classes[]       # Классы в компоненте
└── classes[]           # Классы напрямую в модуле

Component
├── components[]        # Субкомпоненты (nested packages)
│   ├── components[]    # Бесконечная вложенность пакетов
│   └── classes[]       # Классы в субкомпоненте
└── classes[]           # Классы в компоненте

Class
└── classes[]           # Вложенные классы (nested classes)
    └── classes[]       # Бесконечная вложенность классов
```

#### Соответствие Java/Spring

**Module → Maven/Gradle:**
- Корневые проекты: `femsq/`
- Sub-modules: `femsq-backend/`, `femsq-frontend/`
- Multi-module проекты: `backend/database/`, `backend/web/`

**Component → Java Packages:**
- `com.femsq.database.config`
- `com.femsq.database.config.internal`
- `com.femsq.database.config.internal.validators`

**Class → Java Classes:**
- `DatabaseConfigurationService`
- `DatabaseConfigurationService.ConfigValidator` (nested class)
- `DatabaseConfigurationService.ConfigValidator.ValidationResult` (nested in nested)

#### Рекомендации по использованию

**✅ Рекомендуется:**
- Модуль → Модуль → Компонент → Компонент → Класс
- Модуль → Компонент → Компонент → Класс
- Компонент → Компонент → Класс

**⚠️ Допустимо:**
- Модуль → Класс (для main классов)
- Компонент → Класс (для простых пакетов)

**❌ Не рекомендуется:**
- Слишком глубокая вложенность (более 7 уровней)
- Смешивание разных типов на одном уровне без логики

#### Нумерация для рекурсивной структуры

**Система иерархической нумерации:**
- **Модули:** 01, 02, 0a, 0b
- **Модули в модуле:** 01.01, 01.02, 01.0a
- **Компоненты:** 01.01.01, 01.01.02, 01.02.01
- **Компоненты в компоненте:** 01.01.01.01, 01.01.01.02
- **Классы:** 01.01.01.01.01, 01.01.01.01.02
- **Классы в классе:** 01.01.01.01.01.01, 01.01.01.01.01.02

**Принцип:** Каждый уровень добавляет свой номер к родительскому

### Группировка атрибутов артефактов

Для улучшения читаемости и возможности сворачивания в IDE, физические атрибуты артефактов группируются в объект `artifact`:

```json
{
  "attributes": {
    "id": "DatabaseConfigService",
    "number": "01.01.01.01",
    "name": "DatabaseConfigService",
    "description": "Сервис для работы с конфигурацией БД",
    "status": "planned",
    
    "artifact": {
      "location": "com.femsq.database.config.DatabaseConfigService",
      "file_path": "src/main/java/com/femsq/database/config/DatabaseConfigService.java",
      "type": "java-class",
      "artifact_type": "file"
    },
    
    "responsibilities": [...],
    "dependsOn": [...]
  }
}
```

**Подробнее:** см. **[project-docs-json-rules-af-types.md](project-docs-json-rules-af-types.md)**

## 1.4. Пример структуры файла

Полный образец структуры файла `project-docs.json` с описанием всех разделов и правильным применением системы структурной нумерации доступен в файле:

**📄 [project-docs-example.json](project-docs-example.json)**

### Использование образца

1. **Для нового проекта:**
   - Скопируйте `project-docs-example.json`
   - Переименуйте в `project-docs.json`
   - Замените абстрактные значения на реальные данные вашего проекта
   - Удалите ненужные секции или добавьте специфичные для вашего проекта

2. **Для существующего проекта:**
   - Используйте образец как референс для структуры
   - Сверяйте наличие всех необходимых разделов
   - Проверяйте правильность системы нумерации

3. **Ключевые правила из образца:**
   - `displayName` всегда в формате `"name. № number"`
   - Нумерация модулей: `01`, `02`, `0a` и т.д.
   - Нумерация компонентов: `01.01`, `01.02`, `01.0a` и т.д.
   - Нумерация классов: `01.01.01`, `01.01.02` и т.д.
   - Файлы конфигурации: буквенная нумерация `01.01.a0`, `01.01.a1` и т.д.
   - Скрипты: буквенная нумерация `01.01.aa`, `01.01.ab` и т.д.

### Обязательные разделы

Минимально необходимые разделы для любого проекта:
- ✅ `metadata` - информация о проекте
- ✅ `architecture` - технологический стек
- ✅ `modules` - структура модулей (может быть пустой на старте)
- ✅ `database` - схема базы данных (если используется БД)
- ✅ `deployment` - стратегия развертывания
- ✅ `development.setup` - инструкции по настройке
- ✅ `resources.team` - информация о команде

### Опциональные разделы

Могут быть добавлены по необходимости:
- `ui` - если есть веб-интерфейс настройки
- `network` - если есть специфичные сетевые требования
- `monitoring` - если есть мониторинг и логирование
- `timeline` - если нужно планирование
- `risks` - если нужен риск-менеджмент

## Структура папки extensions

### Организация расширений
```
docs/project/extensions/
├── modules/                        # Модули проекта
│   ├── modules-example.json        # Пример структуры модулей
│   └── modules.json                # Реальные модули проекта
├── deployment/                     # Конфигурация развертывания
│   ├── deployment-config.json
│   ├── environments.json
│   └── security-config.json
├── database/                       # Конфигурация базы данных
│   ├── connection-config.json
│   ├── authentication-methods.json
│   ├── migration-config.json
│   └── compatibility.json
├── ui/                            # Конфигурация пользовательского интерфейса
│   ├── setup-forms.json
│   ├── status-pages.json
│   └── user-experience.json
├── network/                       # Сетевая конфигурация
│   ├── corporate-network.json
│   └── connection-detection.json
└── monitoring/                    # Мониторинг и логирование
    ├── logging-config.json
    └── health-checks.json
```

### Принципы именования
- **Папки:** соответствуют разделам основного файла
- **Файлы:** `{purpose}-config.json` или `{purpose}.json`
- **Ссылки:** относительные пути от корня docs/

### Правила создания модульных расширений

#### Создание нового модуля
1. **Создать папку** `extensions/modules/{module-name}/`
2. **Создать файл** `{module-name}-module.json`
3. **Добавить ссылку** в `modules/modules.json`
4. **Обновить основной файл** project-docs.json

#### Создание нового компонента
1. **Создать папку** `extensions/modules/{module}/{component}/`
2. **Создать файл** `{component}-component.json`
3. **Добавить ссылку** в родительский модуль
4. **Документировать в журнале**

#### Создание нового класса
1. **Добавить в существующий** компонентный файл
2. **Или создать отдельный файл** для сложных классов
3. **Обновить зависимости** в других файлах
4. **Синхронизировать с PlantUML** диаграммами

### Примеры использования расширений

#### Создание расширения базы данных
```json
// docs/project/extensions/database/connection-config.json
{
  "database_connection": {
    "engine": "MS SQL Server 2019+",
    "driver": "com.microsoft.sqlserver.jdbc.SQLServerDriver",
    "connection_pool": {
      "min_size": 5,
      "max_size": 20
    }
  }
}
```

#### Ссылка в основном файле
```json
{
  "database": {
    "schema": "app_schema",
    "extensions": [
      "docs/project/extensions/database/connection-config.json"
    ]
  }
}
```
